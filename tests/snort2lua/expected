---------------------------------------------------------------------------
-- Snort++ prototype configuration
---------------------------------------------------------------------------

---------------------------------------------------------------------------
-- setup environment
---------------------------------------------------------------------------
-- given:
-- export DIR=/install/path
-- configure --prefix=$DIR
-- make install
--
-- then:
-- export SNORT_LUA_PATH=$DIR/conf/
---------------------------------------------------------------------------

dir = os.getenv('SNORT_LUA_PATH')

if ( not dir ) then
    dir = '.'
end

dofile(dir .. '/snort_defaults.lua')

HOME_NET = 'any'

EXTERNAL_NET = 'any'

DNS_SERVERS = HOME_NET

SMTP_SERVERS = HOME_NET

HTTP_SERVERS = HOME_NET

SQL_SERVERS = HOME_NET

TELNET_SERVERS = HOME_NET

SSH_SERVERS = HOME_NET

FTP_SERVERS = HOME_NET

SIP_SERVERS = HOME_NET

HTTP_PORTS = [[ 80 81 311 383 591 593 901 1220 1414 1741 1830 2301 2381 2809
    3037 3128 3702 4343 4848 5250 6988 7000 7001 7144 7145 7510 7777 7779
    8000 8008 8014 8028 8080 8085 8088 8090 8118 8123 8180 8181 8243 8280
    8300 8800 8888 8899 9000 9060 9080 9090 9091 9443 9999 11371 34443 34444
    41080 50002 55555 ]]

SHELLCODE_PORTS = '!80'

ORACLE_PORTS = '1024:'

SSH_PORTS = '22'

FTP_PORTS = '21 2100 3535'

SIP_PORTS = '5060 5061 5600'

FILE_DATA_PORTS = HTTP_PORTS .. ' 110 143'

GTP_PORTS = '2123 2152 3386'

-- treated as portvar
TEST_PORTS = '! ' .. SSH_PORTS

-- treated as path var
TEST_PATH = './'

-- treated as path var
SOURCE_PATH = './'

-- treated as global var
TEST_VAR = '1 2 3 4 5 6 7 8 9 10 11 12 13 14 ' .. FTP_PORTS .. [[ 15 16 17 18
    19  ]] .. ORACLE_PORTS .. ' ' .. SSH_PORTS .. ' ' .. SIP_PORTS .. ' ' .. 
    FILE_DATA_PORTS

-- treated as path var
RULE_PATH = '.'

-- treated as path var
SO_RULE_PATH = './snort/rules/so_rules'

-- treated as path var
PREPROC_RULE_PATH = './snort/rules/preproc_rules'

-- treated as path var
WHITE_LIST_PATH = './snort/rules'

-- treated as path var
BLACK_LIST_PATH = './snort/rules'

-- treated as global var
BLAH1 = 'ACCT'

wizard = default_wizard

local_states =
[[
# rule_state option 'enable' deleted
drop ( gid:1; sid:1000001; enable:yes; )
# rule_state option 'enable' deleted
alert ( gid:1; sid:1000002; enable:no; )
# rule_state option 'enable' deleted
# rule_state option 'action' deleted
drop ( gid:1; sid:1000003; enable:no; )
# rule_state option 'enable' deleted
# rule_state option 'action' deleted
drop ( gid:1; sid:1000004; enable:yes; )
]]

local_variables =
{
    nets =
    {
        HOME_NET = HOME_NET,
        EXTERNAL_NET = EXTERNAL_NET,
        DNS_SERVERS = DNS_SERVERS,
        SMTP_SERVERS = SMTP_SERVERS,
        HTTP_SERVERS = HTTP_SERVERS,
        SQL_SERVERS = SQL_SERVERS,
        TELNET_SERVERS = TELNET_SERVERS,
        SSH_SERVERS = SSH_SERVERS,
        FTP_SERVERS = FTP_SERVERS,
        SIP_SERVERS = SIP_SERVERS,
    },
    paths =
    {
        TEST_PATH = TEST_PATH,
        SOURCE_PATH = SOURCE_PATH,
        RULE_PATH = RULE_PATH,
        SO_RULE_PATH = SO_RULE_PATH,
        PREPROC_RULE_PATH = PREPROC_RULE_PATH,
        WHITE_LIST_PATH = WHITE_LIST_PATH,
        BLACK_LIST_PATH = BLACK_LIST_PATH,
    },
    ports =
    {
        HTTP_PORTS = HTTP_PORTS,
        SHELLCODE_PORTS = SHELLCODE_PORTS,
        ORACLE_PORTS = ORACLE_PORTS,
        SSH_PORTS = SSH_PORTS,
        FTP_PORTS = FTP_PORTS,
        SIP_PORTS = SIP_PORTS,
        FILE_DATA_PORTS = FILE_DATA_PORTS,
        GTP_PORTS = GTP_PORTS,
        TEST_PORTS = TEST_PORTS,
    },
}

local_rules =
[[
alert tcp $EXTERNAL_NET any -> $TELNET_SERVERS 23 ( msg:"PROTOCOL-TELNET FreeBSD telnetd dec_keyid overflow attempt"; flow:established,to_server; raw_data; content:"|FF FA 26 08|",fast_pattern; pkt_data; isdataat:66,relative; raw_data; content:!"|FF F0|",within 66; metadata:policy balanced-ips drop,policy security-ips drop; service:telnet; reference:bugtraq,51182; reference:cve,2011-4862; reference:url,security.freebsd.org/advisories/FreeBSD-SA-11:08.telnetd.asc; classtype:attempted-admin; sid:20820; rev:6; )
alert tcp any 80 -> any any ( msg:"content detected in chunk"; file_data; content:"nt network testing facility",within 30; sid:1000039; )
alert tcp any any -> any 25 ( msg:"Lorem Ipsum?"; flow:established,to_server; file_data; content:"sollicitudin",nocase; sid:42000009; rev:1; priority:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-IE Microsoft Internet Explorer saveHistory use after free attempt"; flow:to_server,established; file_data; content:"behavior",nocase; content:"url",within 5,nocase; content:"#savehistory",distance 0,fast_pattern,nocase; content:".outerHTML",distance 0,nocase; pcre:"/<\s*meta[^>]*?(?>content\s*=\s*"history"[^>]*?name\s*=\s*"save"|name\s*=\s*"save"[^>]*?content\s*=\s*"history")\s*>.*?<\s*style[^>]*?>.*?\.(?P<class>\w+)\s*\{[^}]*?behavior\s*\:[^\;]*?url\s*\x28[^\x29]*?#savehistory[^\x29]*?\x29.*?(?P<element>\w+)\.outerHTML\s*=.*?id\s*=\s*[\x22\x27](?P=element)[\x22\x27].*?class=[\x22\x27]?(?P=class)[\x23\x27]?/ims"; metadata:policy balanced-ips drop,policy security-ips drop; service:smtp; reference:cve,2013-0088; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021; classtype:attempted-dos; sid:26133; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [80,443,8200] ( msg:"APP-DETECT GoToMyPC local service running"; raw_data; content:"jedi request",nocase,offset 4,depth 20; http_header; content:"jedi request2",nocase,distance 150; http_client_body; content:"jedi request3",within 150; http_cookie; content:"jedi request4"; pkt_data; content:"jedi request5 -- containt pkt data"; sid:1000060; gid:1; rev:6; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [80,443,8200] ( msg:"APP-DETECT GoToMyPC local service running"; http_client_body; content:"http_client_body"; http_cookie; content:"http_cookie"; http_raw_cookie; content:"http_raw_cookie"; http_header; content:"http_header"; http_raw_header; content:"http_raw_header"; http_method; content:"http_method"; http_uri; content:"http_uri"; http_raw_uri; content:"http_raw_uri"; http_stat_code; content:"http_stat_code"; http_stat_msg; content:"http_stat_msg"; pkt_data; pcre:"/mos\s{2}\dm\s\d/"; sid:7034; gid:1; rev:6; )
# fast_pattern's 'only' option has been deleted
alert tcp any any -> any any ( msg:"la di da"; content:"fast_parttern",fast_pattern,nocase; sid:7035; gid:1; rev:6; )
alert tcp any any -> any any ( msg:"fast_pattern offset length"; content:"fast_parttern",fast_pattern,fast_pattern_offset 1,fast_pattern_length 5; sid:7036; gid:1; rev:6; )
# uricontent deprecated --> 'http_uri: content:'foo'
alert tcp $HOME_NET any -> $EXTERNAL_NET [80,443,8200] ( msg:"uricontent"; http_uri; content:"jedi request",nocase,offset 4,depth 20; sid:7037; gid:1; rev:6; )
# uricontent deprecated --> 'http_uri: content:'foo'
alert tcp $HOME_NET any -> $EXTERNAL_NET [80,443,8200] ( msg:"uricontent"; http_uri; content:"jedi request",nocase,within 30,distance 50; sid:7038; gid:1; rev:6; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [80,443,8200] ( msg:"APP-DETECT GoToMyPC local service running"; flow:to_server,established; content:"jedi request",nocase; sid:7033; rev:6; gid:1; )
# uricontent deprecated --> 'http_uri: content:'foo'
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"WEB-CLIENT csv file download request"; flow:to_server, established; content:"GET",nocase; http_uri; content:".csv",nocase; flowbits:set,csv.download; flowbits:noalert; service:http; reference:cve,2008-0112; reference:url,www.microsoft.com/technet/security/Bulletin/MS08-014.mspx; classtype:misc-activity; sid:13584; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 3389 ( msg:"APP-DETECT remote desktop protocol attempted administrator connection request"; content:"|E0|",depth 1,offset 5; content:"mstshash=Administr",distance 0,nocase; reference:bugtraq,14259; reference:cve,2005-1218; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-041; classtype:misc-activity; sid:4060; rev:8; )
# metadata: rule-flushing - deprecated
alert ( msg:"DECODE_ICMP4_DST_BROADCAST"; sid:1000042; gid:1; rev:1; metadata:rule-type decode; service:http; classtype:misc-activity; )
alert ( msg:"DECODE_ICMP4_TYPE_OTHER"; sid:1000043; gid:1; rev:1; metadata:rule-type decode; classtype:misc-activity; )
# Ruletype 'drop' discards the current packet only; using 'block' to discard all packets on flow
# metadata: engine - deprecated
# block tcp $EXTERNAL_NET 554 -> $HOME_NET any ( msg:"MULTIMEDIA Windows Media Player malicious playlist buffer overflow attempt"; sid:14252; gid:3; rev:9; classtype:attempted-user; flowbits:isset,file.wmp_playlist; reference:cve,2008-2253; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-054; metadata:policy balanced-ips drop,policy security-ips drop; soid:3|14252; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"APP-DETECT Amazon Kindle 3.0 User-Agent string requested"; flow:to_server,established; http_header; content:"Kindle/3.0+",fast_pattern,nocase; pcre:"/^User-Agent\x3A[^\r\n]+Kindle\x2F3\x2E0\x2B/smi"; flowbits:set,kindle.request; flowbits:noalert; service:http; classtype:misc-activity; sid:23616; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 1978 ( msg:"APP-DETECT Apple OSX Remote Mouse usage"; flow:to_server,established; content:"mos ",fast_pattern,nocase; pcre:"/mos\s{2}\dm\s\d/"; reference:url,pastebin.com/F81NCiYE; classtype:policy-violation; sid:20443; rev:2; )
alert tcp $EXTERNAL_NET !22 -> $HOME_NET any ( msg:"APP-DETECT SSH server detected on non-standard port"; flow:to_client,established; content:"SSH-",depth 4,nocase; pcre:"/^SSH-[12]\.\d+/smi"; reference:url,www.ietf.org/rfc/rfc4251.txt; classtype:protocol-command-decode; sid:13586; rev:4; )
alert tcp $HOME_NET 143 -> $EXTERNAL_NET any ( msg:"APP-DETECT failed IMAP login attempt - invalid username/password"; flow:to_client,established; content:"NO LOGIN",fast_pattern,nocase; pcre:"/^\s*\w+\s+NO LOGIN/smi"; metadata:policy security-ips alert; service:imap; reference:url,www.ietf.org/rfc/rfc3501.txt; classtype:misc-activity; sid:13359; rev:7; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"APP-DETECT Google Desktop activity"; flow:to_server,established; http_header; content:"User-Agent|3A|",nocase; content:"Google",nocase; content:"Desktop",nocase; pcre:"/User-Agent\x3A[^\n\r]+Google[^\n\r]+Desktop/smi"; service:http; classtype:policy-violation; sid:7861; rev:6; )
alert udp $HOME_NET any -> $EXTERNAL_NET 5060 ( msg:"APP-DETECT Gizmo register VOIP state"; content:"INVITE sip|3A|",nocase; content:"User-Agent|3A|",nocase; content:"Gizmo",fast_pattern,nocase; pcre:"/^User-Agent\x3A[^\n\r]+Gizmo/smi"; reference:url,www.gizmoproject.com; classtype:policy-violation; sid:6407; rev:4; )
alert ip $EXTERNAL_NET any -> $HOME_NET any ( msg:"DOS IGMP dos attack"; fragbits:M+; ip_proto:2; reference:bugtraq,514; reference:cve,1999-0918; reference:url,www.microsoft.com/technet/security/bulletin/MS99-034.mspx; classtype:attempted-dos; sid:1000044; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"ET SCAN NMAP -f -sF"; fragbits:!M; dsize:0; flags:F,12; ack:0; window:2048; classtype:attempted-recon; reference:url,doc.emergingthreats.net/2000543; reference:url,www.emergingthreats.net/cgi-bin/cvsweb.cgi/sigs/SCAN/SCAN_NMAP; sid:2000543; rev:6; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"BROWSER-IE Microsoft multiple product toStaticHTML XSS attempt"; flow:to_server,established; file_data; content:"<style",fast_pattern,nocase; pcre:"/<\s*style\s*>\s*\w+\s*\{\s*(\w+|\w+-\w+)\s*\:\s*\w+\s*\(.*?(\s*\x27\s*|\s*\&\#39\;\s*|\s*\&\#x27\;\s*|\s*\\u0027\;\s*){1}.*?\)\s*(\s*\x27\s*|\s*\&\#39\;\s*|\s*\&\#x27\;\s*|\s*\\u0027\;\s*){3,}.*?\}|(\s*\x27\s*|\s*\&\#39\;\s*|\s*\&\#x27\;\s*|\s*\\u0027\;\s*){1,}.*?\}\s*(\s*\x27\s*|\s*\&\#39\;\s*|\s*\&\#x27\;\s*|\s*\\u0027\;\s*){3,}/smi"; service:smtp; reference:cve,2012-1858; reference:cve,2012-2520; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-037; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-039; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-050; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-066; classtype:attempted-user; sid:23137; rev:7; )
alert tcp any any -> any any ( msg:"test base64_decode"; base64_decode; sid:1000001; gid:1; )
alert tcp any any -> any any ( msg:"test base64_decode"; base64_decode; base64_data; sid:1000002; gid:1; )
alert tcp any any -> any any ( msg:"test base64_decode"; base64_decode:relative; base64_data; sid:1000003; gid:1; )
alert tcp any any -> any any ( msg:"test base64_decode"; base64_decode:bytes 12, offset 6, relative; base64_data; sid:1000004; gid:1; )
alert tcp any any -> any any ( msg:"test base64_decode"; base64_decode:offset 7; sid:1000005; gid:1; )
alert tcp any any <> any any ( base64_decode:bytes 10,offset 8,relative; sid:1000007; gid:1; )
alert tcp any any -> any any ( msg:"test base64_decode"; asn1:bitstring_overflow; sid:1000010; gid:1; )
# file_data's 'mime' option has been deleted
alert tcp any any <> any any ( msg:"blahblahblah"; file_data; sid:1000045; )
# file_data's 'mime' option has been deleted
alert tcp any any <> any any ( file_data; msg:"blahblahblah"; sid:1000046; )
alert tcp any any -> any 80 ( sid:1000047; gid:119; )
alert tcp any any -> any 80 ( sid:1000048; gid:1; )
alert tcp any any -> any 80 ( sid:1000049; gid:1; )
alert tcp any any -> any 80 ( sid:1000050; gid:1; )
alert tcp any any -> any 80 ( content:"blah"; gid:1; sid:1000051; )
alert tcp any any -> any any ( msg:"ARJ"; file_type:"ARJ"; sid:2000000; )
alert tcp any any -> any any ( msg:"PDF SWF"; file_type:"PDF,1.0,1.1,1.2 SWF"; sid:1000051; flow:established,to_client; )
reject tcp any any <> any any ( sid:1000052; msg:"x"; )
react tcp any any <> any 80 ( sid:1000020; msg:"x"; )
react tcp any any <> any 80 ( sid:1000021; msg:"x"; )
# react: msg - deprecated
react tcp any any <> any 80 ( sid:1000022; msg:"x"; )
react tcp any any <> any 80 ( sid:1000023; msg:"x"; )
# react: msg - deprecated
react tcp any any <> any 80 ( sid:1000024; msg:"x"; )
reject tcp any any <> any any ( sid:1000027; msg:"x"; )
reject tcp any any <> any any ( sid:1000026; msg:"x"; )
reject tcp any any <> any any ( sid:1000028; msg:"x"; )
reject tcp any any <> any any ( sid:1000029; msg:"x"; )
reject tcp any any <> any any ( sid:1000030; msg:"x"; )
reject tcp any any <> any any ( sid:1000031; msg:"x"; )
reject tcp any any <> any any ( sid:1000032; msg:"x"; )
reject tcp any any <> any any ( sid:1000033; msg:"x"; )
reject tcp any any <> any any ( sid:1000034; msg:"x"; )
reject tcp any any <> any any ( sid:1000035; msg:"x"; )
reject tcp any any <> any any ( sid:1000036; msg:"x"; )
reject tcp any any <> any any ( sid:1000037; msg:"x"; )
reject tcp any any <> any any ( sid:1000038; msg:"x"; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.ZeroAccess URI and Referer"; flow:to_server,established; http_raw_uri; bufferlen:52; http_header; content:"/s/?k=",fast_pattern,nocase; http_uri; pcre:"/^\x2f[a-z0-9]{51}$/i"; http_header; pcre:"/Referer\x3a\s*?http\x3a\x2f{2}[a-z0-9\x2e\x2d]+\x2fs\x2f\x3fk\x3d/i"; metadata:policy balanced-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:25224; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [110,8080] ( msg:"MALWARE-CNC Win.Trojan.Basutra variant outbound connection"; flow:to_server,established; content:"|7E 77 6F 6F 6F 6F|",depth 6; metadata:impact_flag red,policy balanced-ips drop,policy security-ips drop; service:pop3; reference:url,www.virustotal.com/file/1F8FB6C3EEEB6F17A6D08094B3154DF2C517BFB52698E72DBF8D197A201941A3/analysis/; classtype:trojan-activity; sid:25249; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Worm.Gamarue outbound connection"; flow:to_server,established; http_method; content:"POST"; http_raw_uri; bufferlen:12; http_uri; content:"/a/image.php",fast_pattern,nocase; http_header; content:"User-Agent|3A 20|Mozilla/4.0|0D 0A|"; metadata:impact_flag red,policy balanced-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:25256; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.Skintrim outbound connection"; flow:to_server,established; http_method; content:"POST"; http_uri; content:"/bin/check.php?cv="; http_header; content:"ThIs_Is_tHe_bouNdaRY_$",fast_pattern; metadata:policy balanced-ips drop,policy security-ips drop,ruleset community; service:http; reference:url,www.virustotal.com/file/80e67695fa394f56fd6ddae74b72e9050f651244aad52ad48ebe6304edff95e2/analysis/1357239259/; classtype:trojan-activity; sid:25257; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"OS-WINDOWS SMB-DS DCERPC Remote Activation bind attempt"; flow:to_server,established; content:"|FF|SMB%",depth 5,offset 4,nocase; content:"&|00|",within 2,distance 56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00|",within 12,distance 5,nocase; content:"|05|",within 1; content:"|0B|",within 1,distance 1; byte_test:1,&,1,0,relative; content:"|B8|J|9F|M|1C|}|CF 11 86 1E 00| |AF|n|7C|W",within 16,distance 29; tag:session,packets 5; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy security-ips drop,ruleset community; service:netbios-ssn; reference:bugtraq,8234; reference:bugtraq,8458; reference:cve,2003-0528; reference:cve,2003-0605; reference:cve,2003-0715; reference:nessus,11798; reference:nessus,11835; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-039; classtype:attempted-admin; sid:2254; rev:20; )
alert tcp $EXTERNAL_NET any -> $TELNET_SERVERS 23 ( msg:"PROTOCOL-TELNET FreeBSD telnetd dec_keyid overflow attempt"; flow:established,to_server; raw_data; content:"|FF FA 26 08|",fast_pattern; pkt_data; isdataat:66,relative; raw_data; content:!"|FF F0|",within 66; metadata:policy balanced-ips drop,policy security-ips drop; service:telnet; reference:bugtraq,51182; reference:cve,2011-4862; reference:url,security.freebsd.org/advisories/FreeBSD-SA-11:08.telnetd.asc; classtype:attempted-admin; sid:20813; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 ( msg:"SERVER-MAIL Alt-N MDaemon IMAP Server FETCH command buffer overflow attempt"; flow:to_server,established; flowbits:isset,server.mdaemon; content:"FETCH",fast_pattern,nocase; content:"BODY"; content:"["; isdataat:256,relative; content:!"]",within 256; metadata:policy balanced-ips drop,policy security-ips drop; service:imap; reference:bugtraq,28245; reference:cve,2008-1358; reference:url,files.altn.com/MDaemon/Release/RelNotes_en.txt; classtype:attempted-admin; sid:13663; rev:7; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-MULTIMEDIA AVI file chunk length integer overflow attempt"; flow:to_client,established; flowbits:isset,file.avi.video; file_data; content:"AVI LIST",depth 8,offset 8; content:"hdrlavih",within 8,distance 4; content:"INFO",distance 0; byte_extract:4,4,chunk_size,relative,little; isdataat:!chunk_size; metadata:policy balanced-ips drop,policy security-ips drop; service:http, imap, pop3; reference:cve,2011-3834; reference:url,forums.winamp.com/showthread.php?t=332010; classtype:attempted-user; sid:21168; rev:4; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-MULTIMEDIA AVI file chunk length integer overflow attempt"; flow:to_server,established; flowbits:isset,file.avi.video; file_data; content:"AVI LIST",depth 8,offset 8; content:"hdrlavih",within 8,distance 4; content:"INFO",distance 0; byte_extract:4,4,chunk_size,relative,little; isdataat:!chunk_size; metadata:policy balanced-ips drop,policy security-ips drop; service:smtp; reference:cve,2011-3834; reference:url,forums.winamp.com/showthread.php?t=332010; classtype:attempted-user; sid:24955; rev:2; )
alert tcp $EXTERNAL_NET any -> $TELNET_SERVERS 23 ( msg:"PROTOCOL-TELNET FreeBSD telnetd enc_keyid overflow attempt"; flow:established,to_server; raw_data; content:"|FF FA 26 07|",fast_pattern; pkt_data; isdataat:66,relative; raw_data; content:!"|FF F0|",within 66; metadata:policy balanced-ips drop,policy security-ips drop; service:telnet; reference:bugtraq,51182; reference:cve,2011-4862; reference:url,security.freebsd.org/advisories/FreeBSD-SA-11:08.telnetd.asc; classtype:attempted-admin; sid:20812; rev:6; )
alert tcp $EXTERNAL_NET any -> $TELNET_SERVERS 23 ( msg:"PROTOCOL-TELNET FreeBSD telnetd dec_keyid overflow attempt"; flow:established,to_server; raw_data; content:"|FF FA 26 08|",fast_pattern; pkt_data; isdataat:66,relative; raw_data; content:!"|FF F0|",within 66; metadata:policy balanced-ips drop,policy security-ips drop; service:telnet; reference:bugtraq,51182; reference:cve,2011-4862; reference:url,security.freebsd.org/advisories/FreeBSD-SA-11:08.telnetd.asc; classtype:attempted-admin; sid:20814; rev:6; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"INDICATOR-COMPROMISE Unix.Backdoor.Cdorked redirected URI attempt"; flow:to_server,established; http_uri; bufferlen:>150; content:"/index.php?",fast_pattern,nocase; http_header; content:"Host:",nocase; pcre:"/^Host:\s*?[a-f0-9]{16}\./im"; metadata:impact_flag red,policy balanced-ips drop,policy security-ips drop; service:http; reference:url,blog.sucuri.net/2013/04/apache-binary-backdoors-on-cpanel-based-servers.html; reference:url,virustotal.com/en/file/7b3cd8c1bd0249df458084f28d91648ad14e1baf455fdd53b174481d540070c6/analysis/; classtype:trojan-activity; sid:26530; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-OTHER NeoSploit Malvertising - URI Requested"; flow:to_server,established; http_raw_uri; bufferlen:>62; pkt_data; content:"GET /?",fast_pattern,nocase; http_uri; pcre:"/\/\?[0-9a-f]{60,66}[\;\d]*$/"; metadata:policy balanced-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:23058; rev:2; )
# urilen: option change: '<>' --> '<=>'
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"EXPLOIT-KIT Redkit exploit kit landing page"; flow:to_server,established; http_raw_uri; bufferlen:18<=>21; http_uri; content:".html?h=",fast_pattern,nocase; pcre:"/\/[a-z]{4}\.html\?h\=\d{6,7}$/i"; metadata:policy balanced-ips drop,policy security-ips drop; service:http; reference:cve,2012-0188; reference:cve,2012-0507; reference:cve,2012-1723; reference:cve,2012-4681; reference:cve,2013-0422; reference:cve,2013-2423; reference:url,blog.malwarebytes.org/intelligence/2013/04/redkit-exploit-kit-does-the-splits/; classtype:trojan-activity; sid:26345; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"EXPLOIT-KIT Blackholev2 exploit kit Initial Gate from Linked-In Mailing Campaign"; flow:to_server,established; http_uri; bufferlen:17; content:"/linkendorse.html",fast_pattern,nocase; metadata:policy balanced-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:26814; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"EXPLOIT-KIT Blackholev2 exploit kit Initial Gate from Linked-In Mailing Campaign"; flow:to_server,established; http_raw_uri; bufferlen:17; http_uri; content:"/linkendorse.html",fast_pattern,nocase; metadata:policy balanced-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:26815; rev:1; )
alert tcp any any -> any any ( sid:26816; msg:"tunnel"; flow:established; content:"250-localhost"; stream_reassemble:action disable,direction both,fastpath; )
alert tcp any any -> any any ( sid:26817; msg:"tunnel"; flow:established; content:"250-localhost"; stream_reassemble:action enable,direction client,fastpath,noalert; )
alert tcp any any -> any any ( sid:26818; msg:"tunnel"; flow:established; content:"250-localhost"; stream_reassemble:action enable,direction server,fastpath,noalert; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 2401 ( msg:"MISC CVS non-relative path access attempt"; flow:to_server,established; content:"Argument"; pcre:"m?^Argument\s+/?smi"; pcre:"/^Directory/smiR"; reference:bugtraq,9178; reference:cve,2003-0977; reference:nessus,11947; classtype:misc-attack; sid:2318; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 135 ( msg:"DELETED NETBIOS DCERPC Remote Activation bind attempt"; flow:to_server,established; content:"|05|",depth 1; content:"|0B|",within 1,distance 1; byte_test:1,&,1,0,relative; content:"|B8|J|9F|M|1C|}|CF 11 86 1E 00| |AF|n|7C|W",within 16,distance 29; tag:host_dst,seconds 40,bytes 30; reference:bugtraq,8234; reference:bugtraq,8458; reference:cve,2003-0528; reference:cve,2003-0605; reference:cve,2003-0715; reference:nessus,11798; reference:nessus,11835; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-039; classtype:attempted-admin; sid:2251; rev:18; )
alert tcp $EXTERNAL_NET any -> any $TEST_PORTS ( msg:"DELETED NETBIOS DCERPC Remote Activation bind attempt"; flow:to_server,established; content:"|05|",depth 1; content:"|0B|",within 1,distance 1; byte_test:1,&,1,0,relative; content:"|B8|J|9F|M|1C|}|CF 11 86 1E 00| |AF|n|7C|W",within 16,distance 29; tag:host_src,seconds 40,bytes 30; reference:bugtraq,8234; reference:bugtraq,8458; reference:cve,2003-0528; reference:cve,2003-0605; reference:cve,2003-0715; reference:nessus,11798; reference:nessus,11835; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-039; classtype:attempted-admin; sid:2252; rev:18; )
# tag: [,exclusive] is currently unsupported
alert tcp $EXTERNAL_NET any -> $HOME_NET 135 ( msg:"DELETED NETBIOS DCERPC Remote Activation bind attempt"; flow:to_server,established; content:"|05|",depth 1; content:"|0B|",within 1,distance 1; byte_test:1,&,1,0,relative; content:"|B8|J|9F|M|1C|}|CF 11 86 1E 00| |AF|n|7C|W",within 16,distance 29; tag:session,packets 5; reference:bugtraq,8234; reference:bugtraq,8458; reference:cve,2003-0528; reference:cve,2003-0605; reference:cve,2003-0715; reference:nessus,11798; reference:nessus,11835; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-039; classtype:attempted-admin; sid:2253; rev:18; )
alert tcp $EXTERNAL_NET any -> any $TEST_PORTS ( msg:"MISC CVS non-relative path access attempt"; flow:to_server,established; content:"Argument"; pcre:!"m?^Argument\s+/?smi"; pcre:"m?^Argument\s+/?smi"; pcre:"/^Directory/smiR"; reference:bugtraq,9178; reference:cve,2003-0977; reference:nessus,11947; classtype:misc-attack; sid:2319; rev:4; )
alert tcp any any -> any any ( msg:"First Cookie"; http_uri; content:"OvCgi"; http_cookie; content:"AcceptLang=en-usaAAAA",nocase; sid:11111111; )
alert ip any any -> any any ( msg:"TTL RULE OPTION"; ttl:<=4; sid:11111112; )
alert ip any any -> any any ( msg:"TTL RULE OPTION"; ttl:5<=>6; sid:11111113; )
alert ip any any -> any any ( msg:"TTL RULE OPTION"; ttl:>=7; sid:11111114; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( content:"fe, fe, fe, fe, fe, fe, fe,"; msg:"BROWSER-FIREFOX Mozilla Firefox Javascript engine function arguments memory corruption attempt"; flow:to_client,established; file_data; content:"|3B|i<25|3B|i++|29| fe += fe|3B|",fast_pattern,nocase; content:"fu=new Function|28 0A|"; content:"fe, fe, fe, fe, fe, fe, fe,",within 30; metadata:policy balanced-ips drop,policy security-ips drop; service:http; reference:bugtraq,19181; reference:cve,2006-3806; classtype:attempted-user; sid:18262; rev:3; )
# stream_size: option change: 'client' --> 'to_server'
alert tcp any any -> any 20031 ( msg:"SERVER-OTHER BakBone NetVault server heap overflow attempt"; flow:to_server,established; stream_size:>32784,to_server; byte_test:4,>,32784,0,little; sid:12081; rev:6; )
alert tcp $EXTERNAL_NET [20,1024:] -> $HOME_NET [20,1024:] ( msg:"PROTOCOL-FTP Computer Associates eTrust Secure Content Manager LIST stack overflow attempt"; flow:established; stream_size:<12800,either; content:"4096",fast_pattern,nocase; pcre:"/[D\x2D][RWX\x2D]{9}\s+\w+\s+\w+\s+\w+\s+4096/i"; service:ftp; reference:bugtraq,29528; reference:cve,2008-2541; reference:url,osvdb.org/show/osvdb/46012; reference:url,osvdb.org/show/osvdb/46013; sid:18575; rev:4; )
# stream_size: option change: 'server' --> 'to_client'
alert tcp any any -> any 20031 ( msg:"SERVER-OTHER BakBone NetVault server heap overflow attempt"; flow:to_server,established; stream_size:=32784,to_client; byte_test:4,>,32784,0,little; sid:12082; rev:7; )
alert tcp any any -> any 20031 ( msg:"SERVER-OTHER BakBone NetVault server heap overflow attempt"; flow:to_server,established; stream_size:!=32784,both; byte_test:4,>,32784,0,little; sid:12083; rev:8; )
alert tcp any any -> any 20031 ( msg:"SERVER-OTHER BakBone NetVault server heap overflow attempt"; flow:to_server,established; stream_size:<=32784,to_server; byte_test:4,>,32784,0,little; sid:12084; rev:9; )
alert tcp any any -> any 20031 ( msg:"SERVER-OTHER BakBone NetVault server heap overflow attempt"; flow:to_server,established; stream_size:>=32784,to_server; byte_test:4,>,32784,0,little; sid:12085; rev:10; )
# uricontent deprecated --> 'http_uri: content:'foo'
alert any any -> any any ( msg:"uricontent snort.lua conversion"; http_method; content:"POST"; http_uri; content:"index.html"; pkt_data; content:"Test"; sid:11111; )
# uricontent deprecated --> 'http_uri: content:'foo'
alert any any -> any any ( msg:"uricontent snort.lua conversion"; http_uri; content:"uricontent.html"; pkt_data; content:"GET"; sid:11112; )
# uricontent deprecated --> 'http_uri: content:'foo'
alert any any -> any any ( msg:"uricontent snort.lua conversion"; http_uri; content:"index.html"; http_method; content:"GET"; sid:11113; )
# uricontent deprecated --> 'http_uri: content:'foo'
# uricontent deprecated --> 'http_uri: content:'foo'
alert any any -> any any ( msg:"uricontent snort.lua conversion"; content:"GET"; http_uri; content:"uricontent.html"; content:!"|2f|admin|2f|",nocase; sid:11114; )
# uricontent deprecated --> 'http_uri: content:'foo'
# uricontent deprecated --> 'http_uri: content:'foo'
alert any any -> any any ( msg:"uricontent snort.lua conversion"; flow:established,to_server; http_uri; content:"Adminhtml",nocase; content:!"|2f|admin|2f|",nocase; sid:11115; )
# uricontent deprecated --> 'http_uri: content:'foo'
# uricontent deprecated --> 'http_uri: content:'foo'
alert any any -> any any ( msg:"uricontent snort.lua conversion"; flow:established,to_server; http_uri; content:"Adminhtml",nocase; pkt_data; content:"POST"; http_uri; content:!"|2f|admin|2f|",nocase; sid:11116; )
alert tcp any any -> any any ( sid:11117; msg:"byte_math_RS,byte_extract and byte_test"; byte_math:oper >>,rvalue 4, relative, result var, offset 4, endian big,bytes 1; byte_extract:1,0,offset; byte_test:1,>,var,offset; content:"|74 63 6c 61|"; )
log tcp any any -> any any ( msg:"SUSPICIOUS ruletype"; sid:11111115; )
log tcp any any -> any any ( msg:"SUSPICIOUS ruletype"; sid:11111116; )
log tcp any any -> any any ( msg:"SUSPICIOUS ruletype"; sid:111111167; )
]]

file_magic =
{
    { type = 'XLW', id = 1, category = 'Office Documents', msg = 'Excel spreadsheet subheader (MS Office)', rev = 1, group = 'office', magic = { { content = '| 09 08 10 00 00 06 05 00  |', offset = 512, }, }, },
    { type = 'POSIX_TAR', id = 2, category = 'Archive', msg = 'POSIX Tape Archive file', rev = 1, magic = { { content = '| 75 73 74 61 72 00 20 20 |', offset = 257, }, }, },
    { type = 'OLD_TAR', id = 3, category = 'Archive', msg = 'Pre-POSIX Tape Archive file', rev = 1, magic = { { content = '| 75 73 74 61 72 20 |', offset = 257, }, }, },
    { type = 'MOV', id = 4, category = 'Multimedia', msg = 'QuickTime movie file', rev = 1, group = 'video', magic = { { content = '| 66 72 65 65  |', offset = 4, }, }, },
    { type = 'MOV', id = 5, category = 'Multimedia', msg = 'QuickTime movie file', rev = 1, group = 'video', magic = { { content = '| 6D 6F 6F 76  |', offset = 4, }, }, },
    { type = 'MOV', id = 6, category = 'Multimedia', msg = 'QuickTime movie file', rev = 1, group = 'video', magic = { { content = '| 6D 64 61 74  |', offset = 4, }, }, },
    { type = 'MOV', id = 7, category = 'Multimedia', msg = 'QuickTime movie file', rev = 1, group = 'video', magic = { { content = '| 70 6E 6F 74  |', offset = 4, }, }, },
    { type = 'MOV', id = 8, category = 'Multimedia', msg = 'QuickTime movie file', rev = 1, group = 'video', magic = { { content = '| 66 74 79 70  |', offset = 4, }, }, },
    { type = 'LHA', id = 9, category = 'Archive', msg = 'File compressed with lha utility/algorithm (lha, lzh)', rev = 1, magic = { { content = '| 2D 6C 68 |', offset = 2, }, }, },
    { type = 'ISO', id = 10, category = 'System files', msg = 'Disc Image file based on ISO-9660 standard (iso)c', rev = 1, magic = { { content = '| 43 44 30 30 31 |', offset = 32769, }, }, },
    { type = 'ISO', id = 11, category = 'System files', msg = 'Disc Image file based on ISO-9660 standard (iso)c', rev = 1, magic = { { content = '| 43 44 30 30 31 |', offset = 34817, }, }, },
    { type = 'ISO', id = 12, category = 'System files', msg = 'Disc Image file based on ISO-9660 standard (iso)c', rev = 1, magic = { { content = '| 43 44 30 30 31 |', offset = 36865, }, }, },
    { type = 'S3M', id = 13, category = 'Multimedia', msg = 'S3M audio module format', rev = 1, group = 'audio', magic = { { content = '| 53 43 52 4d |', offset = 44, }, }, },
    { type = 'FLIC', id = 14, category = 'Multimedia', msg = 'FLIC Animation file', rev = 2, magic = { { content = '|11 AF|', offset = 4, }, { content = '|40 01|', offset = 8, }, { content = '|c8 00|', offset = 10, }, { content = '|00 00|', offset = 20, }, { content = '|00 00 00 00 00 00 00 00|', offset = 42, }, }, },
    { type = 'FLIC', id = 15, category = 'Multimedia', msg = 'FLIC Animation file', rev = 2, magic = { { content = '|12 AF|', offset = 4, }, { content = '|40 01|', offset = 8, }, { content = '|c8 00|', offset = 10, }, { content = '|00 00|', offset = 20, }, { content = '|00 00 00 00 00 00 00 00|', offset = 42, }, }, },
    { type = 'MSEXE', id = 21, category = 'Executables,Dynamic Analysis Capable', msg = 'Windows/DOS executable file ', rev = 1, magic = { { content = '| 4D 5A|', offset = 0, }, }, },
    { type = 'PDF', id = 22, category = 'PDF files', msg = 'PDF file ', rev = 1, magic = { { content = '| 25 50 44 46|', offset = 0, }, }, },
    { type = 'RTF', id = 23, category = 'Office Documents', msg = 'Rich text format word processing file ', rev = 1, magic = { { content = '| 7B 5C 72 74 66 31|', offset = 0, }, }, },
    { type = 'RIFF', id = 24, category = 'Multimedia', msg = 'Resource Interchange File Format', rev = 1, magic = { { content = '| 52 49 46 46|', offset = 0, }, }, },
    { type = 'MSCHM', id = 25, category = 'Office Documents', msg = 'Microsoft Compiled HTML Help File', rev = 1, magic = { { content = '| 49 54 53 46|', offset = 0, }, }, },
    { type = 'MSCAB', id = 26, category = 'Archive', msg = 'Microsoft Windows CAB', rev = 1, magic = { { content = '| 4D 53 43 46|', offset = 0, }, }, },
    { type = 'MSOLE2', id = 27, category = 'Office Documents', msg = 'Microsoft Office applications OLE Document ', rev = 1, magic = { { content = '| D0 CF 11 E0 A1 B1 1A E1|', offset = 0, }, }, },
    { type = 'MSSZDD', id = 28, category = 'Archive', msg = 'SZDD file format', rev = 1, magic = { { content = '| 53 5A 44 44 88 F0 27 33 |', offset = 0, }, }, },
    { type = 'ZIP', id = 29, category = 'Archive', msg = 'PKZIP archive file', rev = 1, magic = { { content = '| 50 4B 03 04 |', offset = 0, }, }, },
    { type = 'RAR', id = 30, category = 'Archive', msg = 'WinRAR compressed archive file', rev = 1, magic = { { content = '| 52 61 72 21 1A 07 00 |', offset = 0, }, }, },
    { type = '7Z', id = 31, category = 'Archive', msg = '7-Zip compressed file', rev = 1, magic = { { content = '| 37 7A BC AF 27 1C |', offset = 0, }, }, },
    { type = 'BZ', id = 32, category = 'Archive', msg = 'bzip2 compressed archive', rev = 1, magic = { { content = '| 42 5A 68 |', offset = 0, }, }, },
    { type = 'GZ', id = 33, category = 'Archive', msg = 'GZ', rev = 1, magic = { { content = '| 1F 8B 08 |', offset = 0, }, }, },
    { type = 'ARJ', id = 34, category = 'Archive', msg = 'Compressed archive file', rev = 1, magic = { { content = '| 60 EA 00 00 |', offset = 0, }, }, },
    { type = 'ISHIELD_MSI', id = 35, category = 'Executables', msg = 'Install Shield v5.x or 6.x compressed file', rev = 1, magic = { { content = '| 49 53 63 28 |', offset = 0, }, }, },
    { type = 'BINHEX', id = 36, category = 'Executables', msg = 'Macintosh BinHex 4 Compressed Archive', rev = 1, magic = { { content = '| 28 54 68 69 73 20 66 69 6C 65 20 6D 75 73 74 20 62 65 20 63 6F 6E 76 65 72 74 65 64 20 77 69 74 68 20 42 69 6E 48 65 78 20 |', offset = 0, }, }, },
    { type = 'MAIL', id = 37, category = 'Office Documents', msg = 'E-mail files for Netscape, Eudora, Outlook Express and QuickMail.', rev = 1, magic = { { content = '| 46 72 6F 6D 20 20 20 |', offset = 0, }, }, },
    { type = 'MAIL', id = 38, category = 'Office Documents', msg = 'E-mail files for Netscape, Eudora, Outlook Express and QuickMail.', rev = 1, magic = { { content = '| 46 72 6F 6D 20 3F 3F 3F |', offset = 0, }, }, },
    { type = 'MAIL', id = 39, category = 'Office Documents', msg = 'E-mail files for Netscape, Eudora, Outlook Express and QuickMail.', rev = 1, magic = { { content = '| 46 72 6F 6D 3A 20 |', offset = 0, }, }, },
    { type = 'MAIL', id = 40, category = 'Office Documents', msg = 'E-mail files for Netscape, Eudora, Outlook Express and QuickMail.', rev = 1, magic = { { content = '| 52 65 74 75 72 6E 2D 50 61 74 68 3A 20 |', offset = 0, }, }, },
    { type = 'MAIL', id = 41, category = 'Office Documents', msg = 'E-mail files for Netscape, Eudora, Outlook Express and QuickMail.', rev = 1, magic = { { content = '| 58 2D |', offset = 0, }, }, },
    { type = 'TNEF', id = 42, category = 'Office Documents', msg = 'Transport Neutral Encapsulation Format, an E-mail attachment format', rev = 1, magic = { { content = '| 78 9F 3E 22 |', offset = 0, }, }, },
    { type = 'BINARY_DATA', id = 43, category = 'Executables', msg = 'Universal Binary/Java Bytecode', rev = 1, magic = { { content = '| CA FE BA BE|', offset = 0, }, }, },
    { type = 'UUENCODED', id = 44, category = 'Encoded', msg = 'UUencoded file', rev = 1, magic = { { content = '| 62 65 67 69 6E |', offset = 0, }, }, },
    { type = 'SCRENC', id = 45, category = 'Encoded', msg = 'Script encoder file', rev = 1, magic = { { content = '| 23 40 7E 5E |', offset = 0, }, }, },
    { type = 'ELF', id = 46, category = 'Executables', msg = 'Executable and Linking Format executable file (Linux/Unix)', rev = 1, magic = { { content = '| 7F 45 4C 46|', offset = 0, }, }, },
    { type = 'MACHO', id = 47, category = 'Executables', msg = 'Mach object file format ', rev = 1, magic = { { content = '| CE FA ED FE |', offset = 0, }, }, },
    { type = 'MACHO', id = 48, category = 'Executables', msg = 'Mach object file format ', rev = 1, magic = { { content = '| CF FA ED FE |', offset = 0, }, }, },
    { type = 'MACHO', id = 49, category = 'Executables', msg = 'Mach object file format ', rev = 1, magic = { { content = '| FE ED FA CE |', offset = 0, }, }, },
    { type = 'MACHO', id = 50, category = 'Executables', msg = 'Mach object file format ', rev = 1, magic = { { content = '| FE ED FA CF |', offset = 0, }, }, },
    { type = 'SIS', id = 51, category = 'Archive', msg = 'Software Installation Script, an archive for Symbian OS', rev = 1, magic = { { content = '| 19 04 00 10 |', offset = 0, }, }, },
    { type = 'SWF', id = 52, category = 'Multimedia', msg = 'Flash file ', rev = 1, magic = { { content = '| 43 57 53 |', offset = 0, }, }, },
    { type = 'SWF', id = 53, category = 'Multimedia', msg = 'Flash file ', rev = 1, magic = { { content = '| 46 57 53 |', offset = 0, }, }, },
    { type = 'SWF', id = 54, category = 'Multimedia', msg = 'Flash file ', rev = 1, magic = { { content = '| 58 46 49 52|', offset = 0, }, }, },
    { type = 'CPIO_ODC', id = 55, category = 'Archive', msg = 'Archive created with the cpio utility- standard ASCII format', rev = 1, magic = { { content = '| 30 37 30 37 30 37 |', offset = 0, }, }, },
    { type = 'CPIO_NEWC', id = 56, category = 'Archive', msg = 'Archive created with the cpio utility- new ASCII (aka SVR4) format', rev = 1, magic = { { content = '| 30 37 30 37 30 31 |', offset = 0, }, }, },
    { type = 'CPIO_CRC', id = 57, category = 'Archive', msg = 'Archive created with the cpio utility- CRC format', rev = 1, magic = { { content = '| 30 37 30 37 30 32 |', offset = 0, }, }, },
    { type = 'MPEG', id = 58, category = 'Multimedia', msg = 'MPEG video file', rev = 1, group = 'video', magic = { { content = '| 00 00 01 B3|', offset = 0, }, }, },
    { type = 'MPEG', id = 59, category = 'Multimedia', msg = 'MPEG video file', rev = 1, group = 'video', magic = { { content = '| 00 00 01 BA|', offset = 0, }, }, },
    { type = 'EPS', id = 60, category = 'PDF files', msg = 'Adobe encapsulated PostScript file', rev = 1, magic = { { content = '| 25 21 50 53 2D 41 64 6F 62 65 2D |', offset = 0, }, }, },
    { type = 'RMF', id = 61, category = 'Multimedia', msg = 'RealNetworks  RealMedia streaming media file', rev = 1, magic = { { content = '| 2E 52 4D 46 |', offset = 0, }, }, },
    { type = 'GIF', id = 62, category = 'Graphics', msg = 'GIF', rev = 1, group = 'multimedia', magic = { { content = '| 47 49 46 38 37 61 |', offset = 0, }, }, },
    { type = 'GIF', id = 63, category = 'Graphics', msg = 'GIF', rev = 1, group = 'multimedia', magic = { { content = '| 47 49 46 38 39 61 |', offset = 0, }, }, },
    { type = 'MP3', id = 64, category = 'Multimedia', msg = 'MPEG-1 Audio Layer 3 (MP3) audio file', rev = 1, group = 'audio', magic = { { content = '| 49 44 33 |', offset = 0, }, }, },
    { type = 'MP3', id = 65, category = 'Multimedia', msg = 'MPEG-1 Audio Layer 3 (MP3) audio file', rev = 1, group = 'audio', magic = { { content = '| FF FB 90 |', offset = 0, }, }, },
    { type = 'OGG', id = 66, category = 'Multimedia', msg = 'Ogg Vorbis Codec compressed Multimedia file', rev = 1, group = 'audio', magic = { { content = '| 4F 67 67 53 |', offset = 0, }, }, },
    { type = 'RIFX', id = 67, category = 'Multimedia', msg = 'RIFX audio format', rev = 1, group = 'audio', magic = { { content = '| 52 49 46 58  |', offset = 0, }, }, },
    { type = 'SYMANTEC', id = 68, category = 'System files', msg = 'Symantec files', rev = 1, magic = { { content = '| 58 2D 53 79 6D 61 6E 74 65 63 2D |', offset = 0, }, }, },
    { type = 'PNG', id = 69, category = 'Graphics', msg = 'Portable Network Graphics file', rev = 1, group = 'multimedia', magic = { { content = '| 89 50 4E 47 0D 0A 1A 0A |', offset = 0, }, }, },
    { type = 'JPEG', id = 70, category = 'Graphics', msg = 'JPEG/JFIF graphics file', rev = 1, group = 'multimedia', magic = { { content = '| FF D8 FF E0 |', offset = 0, }, }, },
    { type = 'JARPACK', id = 72, category = 'Executables', msg = 'Jar pack file', rev = 1, magic = { { content = '| CA FE D0 0D |', offset = 0, }, }, },
    { type = 'JAR', id = 73, category = 'Archive', msg = 'Java archive file', rev = 3, magic = { { content = '| 50 4B 03 04 |', offset = 0, }, { content = '| 4D 45 54 41 2D 49 4E 46 2F |', offset = 30, }, }, },
    { type = 'FLV', id = 74, category = 'Multimedia', msg = 'Flash video file', rev = 1, group = 'video', magic = { { content = '| 46 4C 56 01 |', offset = 0, }, }, },
    { type = 'WAV', id = 76, category = 'Multimedia', msg = 'Waveform Audio File Format', rev = 1, group = 'audio', magic = { { content = '| 62 65 61 74 |', offset = 0, }, }, },
    { type = 'WAV', id = 77, category = 'Multimedia', msg = 'Waveform Audio File Format', rev = 1, group = 'audio', magic = { { content = '| 4D 58 43 33  |', offset = 0, }, }, },
    { type = 'FFMPEG', id = 78, category = 'Multimedia', msg = 'ffmpeg Multimedia framework', rev = 1, magic = { { content = '| 34 58 4D 56  |', offset = 0, }, }, },
    { type = 'DMG', id = 79, category = 'System files', msg = 'Apple Disk Image', rev = 1, magic = { { content = '| 45 52 02 00   |', offset = 0, }, }, },
    { type = 'DMG', id = 80, category = 'System files', msg = 'Apple Disk Image', rev = 1, magic = { { content = '| 32 49 4D 47    |', offset = 0, }, }, },
    { type = 'IVR', id = 81, category = 'Multimedia', msg = 'RealPlayer video file', rev = 1, group = 'video', magic = { { content = '| 2E 52 45 43  |', offset = 0, }, }, },
    { type = 'IVR', id = 82, category = 'Multimedia', msg = 'RealPlayer video file', rev = 1, group = 'video', magic = { { content = '| 2E 52 31 4D  |', offset = 0, }, }, },
    { type = 'RA', id = 83, category = 'Multimedia', msg = 'RealAudio file', rev = 1, group = 'audio', magic = { { content = '| 2E 52 4D 46 00 00 00 12 00  |', offset = 0, }, }, },
    { type = 'RA', id = 84, category = 'Multimedia', msg = 'RealAudio file', rev = 1, group = 'audio', magic = { { content = '| 2E 72 61 FD 00  |', offset = 0, }, }, },
    { type = 'VMDK', id = 85, category = 'System files', msg = 'Virtual Machine Disk', rev = 1, magic = { { content = '| 43 4F 57 44 |', offset = 0, }, }, },
    { type = 'VMDK', id = 86, category = 'System files', msg = 'Virtual Machine Disk', rev = 1, magic = { { content = '|4B 44 4D |', offset = 0, }, }, },
    { type = 'VMDK', id = 87, category = 'System files', msg = 'Virtual Machine Disk', rev = 1, magic = { { content = '| 23 20 44 69 73 6B 20 44 65 73 63 72 69 70 74 6F |', offset = 0, }, }, },
    { type = 'VMDK', id = 88, category = 'System files', msg = 'Virtual Machine Disk', rev = 1, magic = { { content = '| 2E 03 00 00 01 |', offset = 0, }, }, },
    { type = 'FLAC', id = 89, category = 'Multimedia', msg = 'Free Lossless Audio Codec file', rev = 1, group = 'audio', magic = { { content = '| 66 4C 61 43 00 00 00 22 |', offset = 0, }, }, },
    { type = 'S3M', id = 90, category = 'Multimedia', msg = 'S3M audio module format', rev = 1, group = 'audio', magic = { { content = '| 53 43 52 4d  |', offset = 0, }, }, },
    { type = 'ASF', id = 91, category = 'Multimedia', msg = 'Microsoft Windows Media Audio/Video File ', rev = 1, group = 'audio', magic = { { content = '| 30 26 B2 75 8E 66 CF 11 A6 D9 00 AA 00 62 CE 6C |', offset = 0, }, }, },
    { type = 'MSWORD_MAC5', id = 93, category = 'Office Documents', msg = 'Microsoft Word for Mac 5', rev = 1, group = 'office', magic = { { content = '| FE 37 00 23|', offset = 0, }, }, },
    { type = 'SYLKc', id = 94, category = 'System files', msg = 'Microsoft symbolic Link', rev = 1, magic = { { content = '| 49 44 3B 50  |', offset = 0, }, }, },
    { type = 'WP', id = 95, category = 'Office Documents', msg = 'WordPerfect text and graphics file', rev = 1, magic = { { content = '| FF 57 50 43|', offset = 0, }, }, },
    { type = 'WP', id = 96, category = 'Office Documents', msg = 'WordPerfect text and graphics file', rev = 1, magic = { { content = '| 81 CD AB|', offset = 0, }, }, },
    { type = 'TIFF', id = 97, category = 'Graphics', msg = 'Tagged Image File Format file', rev = 1, group = 'multimedia', magic = { { content = '| 49 49 2A 00|', offset = 0, }, }, },
    { type = 'TIFF', id = 98, category = 'Graphics', msg = 'Tagged Image File Format file', rev = 1, group = 'multimedia', magic = { { content = '| 49 20 49|', offset = 0, }, }, },
    { type = 'TIFF', id = 99, category = 'Graphics', msg = 'Tagged Image File Format file', rev = 1, group = 'multimedia', magic = { { content = '| 4D 4D 00 2A|', offset = 0, }, }, },
    { type = 'TIFF', id = 100, category = 'Graphics', msg = 'Tagged Image File Format file', rev = 1, group = 'multimedia', magic = { { content = '| 4D 4D 00 2B|', offset = 0, }, }, },
    { type = 'MWL', id = 101, category = 'Office Documents', msg = 'Metastock technical analysis program for traders', rev = 1, magic = { { content = '| 5b 4d 65 74 61 53 74 6f 63 6b |', offset = 0, }, }, },
    { type = 'MDB', id = 102, category = 'Office Documents', msg = 'Microsoft Access file', rev = 1, magic = { { content = '| 00 01 00 00 53 74 61 6E 64 61 72 64 20 4A 65 74 20 44 42 |', offset = 0, }, }, },
    { type = 'ACCDB', id = 103, category = 'Office Documents', msg = 'Microsoft Access 2007 file', rev = 1, magic = { { content = '| 00 01 00 00 53 74 61 6E 64 61 72 64 20 41 43 45 20 44 42|', offset = 0, }, }, },
    { type = 'MNY', id = 104, category = 'Office Documents', msg = 'Microsoft Money file', rev = 1, magic = { { content = '| 00 01 00 00 4D 53 49 53 41 4D 20 44 61 74 61 62 61 73 65|', offset = 0, }, }, },
    { type = 'REC', id = 105, category = 'Multimedia', msg = 'RealNetworks Realplayer REC', rev = 1, magic = { { content = '| 2e 72 65 63 00 |', offset = 0, }, }, },
    { type = 'R1M', id = 106, category = 'Multimedia', msg = 'RealNetworks Realplayer R1M', rev = 1, magic = { { content = '| 2e 72 31 6d |', offset = 0, }, }, },
    { type = 'WAB', id = 107, category = 'Office Documents', msg = 'Outlook address file', rev = 1, group = 'office', magic = { { content = '| 9C CB CB 8D 13 75 D2 11 91 58 00 C0 4F 79 56 A4 |', offset = 0, }, }, },
    { type = 'WAB', id = 108, category = 'Office Documents', msg = 'Outlook address file', rev = 1, group = 'office', magic = { { content = '| 81 32 84 C1 85 05 D0 11 B2 90 00 AA 00 3C F6 76 |', offset = 0, }, }, },
    { type = 'M3U', id = 109, category = 'Multimedia', msg = 'Multimedia playlists', rev = 1, magic = { { content = '| 23 45 58 54 4d 33 55 |', offset = 0, }, }, },
    { type = 'MKV', id = 110, category = 'Multimedia', msg = 'Matroska stream file', rev = 1, magic = { { content = '| 1A 45 DF A3 93 42 82 88 6D 61 74 72 6F 73 6B 61|', offset = 0, }, }, },
    { type = 'IMG_PICT', id = 111, category = 'Graphics', msg = 'ChromaGraph Graphics Card Bitmap Graphic file', rev = 1, group = 'multimedia', magic = { { content = '| 50 49 43 54 00 08 |', offset = 0, }, }, },
    { type = 'AMF', id = 112, category = 'Multimedia', msg = 'Advanced Module Format for digital music', rev = 1, group = 'audio', magic = { { content = '| 41 4d 46 |', offset = 0, }, }, },
    { type = 'WEBM', id = 113, category = 'Multimedia', msg = 'WebM audio-video format', rev = 1, group = 'audio,video', magic = { { content = '| 1A 45 DF A3|', offset = 0, }, }, },
    { type = 'MAYA', id = 114, category = 'Graphics', msg = 'Autodesk Maya', rev = 1, magic = { { content = '| 2f 2f 4d 61 79 61 |', offset = 0, }, }, },
    { type = 'MIDI', id = 115, category = 'Multimedia', msg = 'Musical Instrument Digital Interface (MIDI) sound file', rev = 1, group = 'audio', magic = { { content = '| 4D 54 68 64 |', offset = 0, }, }, },
    { type = 'PLS', id = 116, category = 'Multimedia', msg = 'multimedia playlists', rev = 1, magic = { { content = '| 5b 70 6c 61 79 6c 69 73 74 5d |', offset = 0, }, }, },
    { type = 'SMIL', id = 117, category = 'Multimedia', msg = 'Synchronized Multimedia Integration Language', rev = 1, magic = { { content = '| 3c 73 6d 69 6c 3e |', offset = 0, }, }, },
    { type = 'SAMI', id = 119, category = 'Multimedia', msg = 'Synchronized Accessible Media Interchange', rev = 1, magic = { { content = '| 3c 53 41 4d 49 |', offset = 0, }, }, },
    { type = 'NEW_OFFICE', id = 120, category = 'Office Documents', msg = 'Microsoft Office Open XML Format (OOXML) Document (DOCX, PPTX, XLSX)', rev = 1, group = 'office', magic = { { content = '|50 4B 03 04 14 00 06 00|', offset = 0, }, }, },
    { type = 'DWG', id = 130, category = 'Graphics', msg = 'Autodesk AutoCAD file (dwg) ', rev = 1, magic = { { content = '| 41 43 31 30 |', offset = 0, }, }, },
    { type = 'MDI', id = 132, category = 'Office Documents', msg = 'Microsoft Document Imaging file (mdi)', rev = 1, magic = { { content = '| 45 50 |', offset = 0, }, }, },
    { type = 'PGD', id = 133, category = 'System files', msg = 'PGP disk image(PGD)', rev = 1, magic = { { content = '| 50 47 50 64 4D 41 49 4E |', offset = 0, }, }, },
    { type = 'PSD', id = 134, category = 'Graphics', msg = 'Photoshop image file (PSD)', rev = 1, magic = { { content = '|38 42 50 53 |', offset = 0, }, }, },
    { type = '9XHIVE', id = 135, category = 'System files', msg = 'Windows 9x registry hive (REG)', rev = 1, magic = { { content = '| 43 52 45 47 |', offset = 0, }, }, },
    { type = 'REG', id = 136, category = 'System files', msg = 'Windows Registry and Registry Undo files (REG)', rev = 1, magic = { { content = '| 52 45 47 45 44 49 54 |', offset = 0, }, }, },
    { type = 'WMF', id = 137, category = 'Graphics', msg = 'Windows graphics metafile ', rev = 1, magic = { { content = '| 01 00 09 00 00 03 |', offset = 0, }, }, },
    { type = 'WRI', id = 138, category = 'Office Documents', msg = 'Windows Write document file (wri) ', rev = 1, magic = { { content = '| BE 00 00 00 AB 00 00 00 00 00 00 00 00|', offset = 0, }, }, },
    { type = 'RPM', id = 139, category = 'Executables', msg = 'RedHat Package Manager file', rev = 1, magic = { { content = '| ED AB EE DB |', offset = 0, }, }, },
    { type = 'ONE', id = 140, category = 'Office Documents', msg = 'Microsoft OneNote note', rev = 1, group = 'office', magic = { { content = '| E4 52 5C 7B 8C D8 A7 4D AE B1 53 78 D0 29 96 D3 |', offset = 0, }, }, },
    { type = 'MP4', id = 141, category = 'Multimedia', msg = 'MPEG-4 video files', rev = 1, group = 'video', magic = { { content = '| 00 00 00 18 66 74 79 70 33 67 70 35 |', offset = 0, }, }, },
    { type = 'MP4', id = 142, category = 'Multimedia', msg = 'MPEG-4 video files', rev = 1, group = 'video', magic = { { content = '| 00 00 00 14 66 74 79 70 69 73 6F 6D |', offset = 0, }, }, },
    { type = 'PCAP', id = 143, category = 'System files', msg = 'Packet capture file', rev = 1, magic = { { content = '| D4 C3 B2 A1 |', offset = 0, }, }, },
    { type = 'PCAP', id = 144, category = 'System files', msg = 'Packet capture file', rev = 1, magic = { { content = '|34 CD B2 A1 |', offset = 0, }, }, },
    { type = 'PCAP', id = 145, category = 'System files', msg = 'Packet capture file', rev = 1, magic = { { content = '|A1 B2 C3 D4 |', offset = 0, }, }, },
    { type = 'PCAP', id = 146, category = 'System files', msg = 'Packet capture file', rev = 1, magic = { { content = '|A1 B2 CD 34 |', offset = 0, }, }, },
    { type = 'PCAP', id = 147, category = 'System files', msg = 'Packet capture file', rev = 1, magic = { { content = '|52 54 53 53 |', offset = 0, }, }, },
    { type = 'BMP', id = 148, category = 'Graphics', msg = 'Bitmap image file', rev = 1, group = 'multimedia', magic = { { content = '|42  4D |', offset = 0, }, }, },
    { type = 'ICO', id = 149, category = 'Graphics', msg = 'Windows icon file', rev = 1, magic = { { content = '| 00 00 01 00 |', offset = 0, }, }, },
    { type = 'TORRENT', id = 150, category = 'Executables', msg = 'BitTorrent File', rev = 1, magic = { { content = '| 64 38 3A 61 6E 6E 6F 75 6E 63 65  |', offset = 0, }, }, },
    { type = 'AMR', id = 151, category = 'Multimedia', msg = 'Adaptive Multi-Rate Codec File', rev = 1, magic = { { content = '| 23 21 41 4D 52|', offset = 0, }, }, },
    { type = 'SIT', id = 152, category = 'Archive', msg = 'StuffIt compressed archive', rev = 1, magic = { { content = '| 53 49 54 21 00|', offset = 0, }, }, },
    { type = 'PST', id = 153, category = 'Office Documents', msg = 'Microsoft Outlook Personal Folder File', rev = 1, group = 'office', magic = { { content = '| 21 42 44 4E |', offset = 0, }, }, },
    { type = 'HLP', id = 154, category = 'Office Documents', msg = 'Windows Help file', rev = 1, magic = { { content = '| 4C 4E 02 00 |', offset = 0, }, }, },
    { type = 'HLP', id = 155, category = 'Office Documents', msg = 'Windows Help file', rev = 1, magic = { { content = '| 3F 5F 03 00 |', offset = 0, }, }, },
    { type = 'AUTORUN', id = 156, category = 'Executables', msg = 'Windows Autorun setup file', rev = 1, magic = { { content = '| 5B 61 75 74 6F 72 75 6E 5D 0D 0A |', offset = 0, }, }, },
    { type = 'JPEG', id = 157, category = 'Graphics', msg = 'JPEG/JFIF graphics file', rev = 1, group = 'multimedia', magic = { { content = '| FF D8 FF E1 |', offset = 0, }, }, },
    { type = 'ARJ', id = 158, category = 'Archive', msg = 'Compressed archive file', rev = 1, magic = { { content = '| 60 EA |', offset = 0, }, }, },
    { type = 'MP3', id = 159, category = 'Multimedia', msg = 'MPEG-1 Audio Layer 3 (MP3) audio file', rev = 1, group = 'audio', magic = { { content = '| FF FA |', offset = 0, }, }, },
    { type = 'SIT', id = 160, category = 'Archive', msg = 'StuffIt compressed archive', rev = 1, magic = { { content = '| 53 74 75 66 66 49 74 20 |', offset = 0, }, }, },
    { type = 'NTHIVE', id = 161, category = 'System files', msg = 'Windows NT registry hive (REG)', rev = 1, magic = { { content = '| 72 65 67 66 |', offset = 0, }, }, },
    { type = 'WMF', id = 162, category = 'Graphics', msg = 'Windows graphics metafile ', rev = 1, magic = { { content = '| D7 CD C6 9A |', offset = 0, }, }, },
    { type = 'SIS', id = 163, category = 'Archive', msg = 'Software Installation Script, an archive for Symbian OS', rev = 1, magic = { { content = '| 7A 1A 20 10 |', offset = 0, }, }, },
    { type = 'WRI', id = 164, category = 'Office Documents', msg = 'Windows Write document file (wri) ', rev = 1, magic = { { content = '| 31 BE|', offset = 0, }, }, },
    { type = 'WRI', id = 165, category = 'Office Documents', msg = 'Windows Write document file (wri) ', rev = 1, magic = { { content = '| 32 BE|', offset = 0, }, }, },
    { type = 'WAV', id = 166, category = 'Multimedia', msg = 'Waveform Audio File Format', rev = 1, group = 'audio', magic = { { content = '| 52 49 46 46 |', offset = 0, }, { content = '| 57 41 56 45 66 6D 74 20 |', offset = 8, }, }, },
    { type = 'MP4', id = 167, category = 'Multimedia', msg = 'MPEG-4 video files', rev = 1, group = 'video', magic = { { content = '| 66 74 79 70 6D 70 34 32 |', offset = 4, }, }, },
    { type = 'MP4', id = 168, category = 'Multimedia', msg = 'MPEG-4 video files', rev = 1, group = 'video', magic = { { content = '| 66 74 79 70 33 67 70 35 |', offset = 4, }, }, },
    { type = 'MP4', id = 169, category = 'Multimedia', msg = 'MPEG-4 video files', rev = 1, group = 'video', magic = { { content = '| 66 74 79 70 4D 53 4E 56 |', offset = 4, }, }, },
    { type = 'DICM', id = 170, category = 'Multimedia', msg = 'Digital Imaging and Communications in Medicine', rev = 1, magic = { { content = '| 44 49 43 4D |', offset = 128, }, }, },
    { type = 'ZIP_ENC', id = 171, category = 'Archive', msg = 'PKZIP encrypted archive file', rev = 1, magic = { { content = '| 50 4B 03 04 |', offset = 0, }, { content = '| 01 |', offset = 6, }, }, },
    { type = 'EICAR', id = 273, category = 'Executables', msg = 'Standard Anti-Virus Test File', rev = 1, magic = { { content = '| 58 35 4F 21 50 25 |', offset = 0, }, }, },
    { type = 'XPS', id = 275, category = 'Office Documents', msg = 'Microsoft XML Paper Specification Document', rev = 1, magic = { { content = '| 50 4B 03 04 |', offset = 0, }, { content = '| 46 69 78 65 64 44 6F 63 75 6D |', offset = 30, }, }, },
    { type = 'XPS', id = 277, category = 'Office Documents', msg = 'Microsoft XML Paper Specification Document', rev = 1, magic = { { content = '| 50 4B 03 04 |', offset = 0, }, { content = '| 44 6F 63 75 6D 65 6E 74 73 2F |', offset = 30, }, }, },
    { type = 'XPS', id = 278, category = 'Office Documents', msg = 'Microsoft XML Paper Specification Document', rev = 1, magic = { { content = '| 50 4B 03 04 |', offset = 0, }, { content = '| 4D 65 74 61 64 61 74 61 2F |', offset = 30, }, }, },
    { type = 'DMP', id = 279, category = 'System files', msg = 'Windows crash dump file', rev = 1, magic = { { content = '|4D 44 4D 50 93 A7|', offset = 0, }, }, },
    { type = 'DMP', id = 280, category = 'System files', msg = 'Windows crash dump file', rev = 1, magic = { { content = '|50 41 47 45 44 55 36 34|', offset = 0, }, }, },
    { type = 'DMP', id = 281, category = 'System files', msg = 'Windows crash dump file', rev = 1, magic = { { content = '|50 41 47 45 44 55 4D 50|', offset = 0, }, }, },
    { type = 'PDF', id = 282, category = 'PDF files', msg = 'PDF file ', rev = 1, version = '1.0', magic = { { content = '| 25 50 44 46 2D 31 2E 30|', offset = 0, }, }, 
        --option change: 'ver' --> 'version'
},
    { type = 'PDF', id = 283, category = 'PDF files', msg = 'PDF file ', rev = 1, version = '1.1', magic = { { content = '| 25 50 44 46 2D 31 2E 31|', offset = 0, }, }, 
        --option change: 'ver' --> 'version'
},
    { type = 'PDF', id = 284, category = 'PDF files', msg = 'PDF file ', rev = 1, version = '1.2', magic = { { content = '| 25 50 44 46 2D 31 2E 32|', offset = 0, }, }, 
        --option change: 'ver' --> 'version'
},
    { type = 'PDF', id = 285, category = 'PDF files', msg = 'PDF file ', rev = 1, version = '1.3', magic = { { content = '| 25 50 44 46 2D 31 2E 33|', offset = 0, }, }, 
        --option change: 'ver' --> 'version'
},
    { type = 'PDF', id = 286, category = 'PDF files', msg = 'PDF file ', rev = 1, version = '1.4', magic = { { content = '| 25 50 44 46 2D 31 2E 34|', offset = 0, }, }, 
        --option change: 'ver' --> 'version'
},
    { type = 'PDF', id = 287, category = 'PDF files', msg = 'PDF file ', rev = 1, version = '1.5', magic = { { content = '| 25 50 44 46 2D 31 2E 35|', offset = 0, }, }, 
        --option change: 'ver' --> 'version'
},
    { type = 'PDF', id = 288, category = 'PDF files', msg = 'PDF file ', rev = 1, version = '1.6', magic = { { content = '| 25 50 44 46 2D 31 2E 36|', offset = 0, }, }, 
        --option change: 'ver' --> 'version'
},
    { type = 'PDF', id = 289, category = 'PDF files', msg = 'PDF file ', rev = 1, version = '1.7', magic = { { content = '| 25 50 44 46 2D 31 2E 37|', offset = 0, }, }, 
        --option change: 'ver' --> 'version'
},
}

deleted_snort_config_options =
{
    --option deleted: 'config decode_data_link[:.*]'
    --option deleted: 'config disable-attribute-reload-thread[:.*]'
    --option deleted: 'config disable_decode_alerts[:.*]'
    --option deleted: 'config disable_decode_drops[:.*]'
    --option deleted: 'config disable_inline_init_failopen[:.*]'
    --option deleted: 'config disable_ipopt_alerts[:.*]'
    --option deleted: 'config disable_ipopt_drops[:.*]'
    --option deleted: 'config disable_tcpopt_alerts[:.*]'
    --option deleted: 'config disable_tcpopt_drops[:.*]'
    --option deleted: 'config disable_tcpopt_experimental_alerts[:.*]'
    --option deleted: 'config disable_tcpopt_experimental_drops[:.*]'
    --option deleted: 'config disable_tcpopt_obsolete_alerts[:.*]'
    --option deleted: 'config disable_tcpopt_obsolete_drops[:.*]'
    --option deleted: 'config disable_tcpopt_ttcp_alerts[:.*]'
    --option deleted: 'config disable_ttcp_alerts[:.*]'
    --option deleted: 'config disable_ttcp_drops[:.*]'
    --option deleted: 'config dump-dynamic-rules-path[:.*]'
    --option deleted: 'config enable_decode_drops[:.*]'
    --option deleted: 'config enable_decode_oversized_alerts[:.*]'
    --option deleted: 'config enable_decode_oversized_drops[:.*]'
    --option deleted: 'config enable_gtp[:.*]'
    --option deleted: 'config enable_ipopt_drops[:.*]'
    --option deleted: 'config enable_mpls_multicast[:.*]'
    --option deleted: 'config enable_tcpopt_drops[:.*]'
    --option deleted: 'config enable_tcpopt_experimental_drops[:.*]'
    --option deleted: 'config enable_tcpopt_obsolete_drops[:.*]'
    --option deleted: 'config enable_tcpopt_ttcp_drops[:.*]'
    --option deleted: 'config enable_ttcp_drops[:.*]'
    --option deleted: 'config flexresp2_attempts[:.*]'
    --option deleted: 'config flexresp2_interface[:.*]'
    --option deleted: 'config flexresp2_memcap[:.*]'
    --option deleted: 'config flexresp2_rows[:.*]'
    --option deleted: 'config flowbits_size[:.*]'
    --option deleted: 'config include_vlan_in_alerts[:.*]'
    --option deleted: 'config interface[:.*]'
    --option deleted: 'config ipv6_frag: bad_ipv6_frag_alert'
    --option deleted: 'config ipv6_frag: config ipv6_frag: bsd_icmp_frag_alert'
    --option deleted: 'config ipv6_frag: drop_bad_ipv6_frag'
    --option deleted: 'config ipv6_frag: max_frag_sessions'
    --option deleted: 'config layer2resets[:.*]'
    --option deleted: 'config log_ipv6_extra_data[:.*]'
    --option deleted: 'config no_promisc[:.*]'
    --option deleted: 'config nolog[:.*]'
    --option deleted: 'config sidechannel[:.*]'
}

daq =
{
    snaplen = 1450,
    modules =
    {
        {
            name = 'pcap',
            mode = 'read-file',
            variables =
            {
                'blah=hah',
                'debug',
            },
            --option change: 'config daq:' --> 'name'
            --option change: 'config daq_mode:' --> 'mode'
            --option change: 'config daq_var:' --> 'variables'
        },
    },
    module_dirs =
    {
        '/usr/lib/daq/',
        '/usr/local/lib/daq/',
    },
    --option change: 'config daq_dir:' --> 'module_dirs'
}

packets =
{
    bpf_file = './conf/filter',
    mpls_agnostic = false,
    address_space_agnostic = true,
    limit = 400,
    vlan_agnostic = true,
    --option change: 'config addressspace_agnostic:' -->
    --    'address_space_agnostic'
    --option change: 'config enable_mpls_overlapping_ip:' --> 'mpls_agnostic'
    --option change: 'config pkt_count:' --> 'limit'
}

ip_stream =
{
    session_timeout = 55,
}

alerts =
{
    alert_with_interface_name = true,
    stateful = true,
    reference_net = '192.168.192.8/24',
    event_filter_memcap = 1000000,
    event_filter_memcap = 1000001,
    rate_filter_memcap = 1000002,
    detection_filter_memcap = 1000003,
    order = 'log alert drop pass',
    tunnel_verdicts = '4in6 6in4 gtp teredo',
    --option change: 'config detection_filter:' --> 'event_filter_memcap'
    --option change: 'config event_filter:' --> 'event_filter_memcap'
    --option change: 'config rate_filter:' --> 'event_filter_memcap'
    --option change: 'config threshold:' --> 'event_filter_memcap'
}

esp =
{
    decode_esp = true,
    --option change: 'config decode_esp: enable' --> 'decode_esp = true'
}

mpls =
{
    max_stack_depth = 3,
    payload_type = 'eth',
    --option change: 'config max_mpls_labelchain_len:' --> 'max_stack_depth'
    --option change: 'config mpls_payload_type: ethernet' --> 'payload_type =
    --    eth'
}

inspection =
{
    uuid = '11111111-1111-1111-1111-123456789012',
}

output =
{
    verbose = true,
    dump_chars_only = true,
    dump_payload = true,
    dump_payload_verbose = true,
    show_year = true,
    obfuscate = true,
    tagged_packet_limit = 14,
    logdir = './',
    event_trace =
    {
        max_data = 128,
        --option deleted: 'file'
    },
}

process =
{
    umask = 127,
    utc = true,
    dirty_pig = true,
    --plugin_path = './snort/lib/snort_dynamicpreprocessor',
    --plugin_path = './snort/lib/snort_dynamicrules',
    --Cannot add specific files to Snort++ plugin path.  Use 'plugin_path =
    --    <dir>' instead of adding specific file:
    --    ./snort/lib/snort_dynamicengine/libsf_engine.so
    --Since paths have changed between Snort and  Snort++, commenting out any
    --    plugin paths.  You must manually add them
    --option change: 'dynamicdetection' --> 'plugin_path'
    --option change: 'dynamicengine' --> 'plugin_path'
    --option change: 'dynamicpreprocessor' --> 'plugin_path'
}

udp =
{
    deep_teredo_inspection = true,
    --option change: 'config enable_deep_teredo_inspection:' -->
    --    'deep_teredo_inspection'
}

attribute_table =
{
    max_metadata_services = 10,
    max_hosts = 2700,
    max_services_per_host = 80,
    --option change: 'config max_attribute_hosts:' --> 'max_hosts'
    --option change: 'config max_attribute_services_per_host:' -->
    --    'max_services_per_host'
}

react =
{
    page = './conf/block.html',
    --option change: 'config react:' --> 'page'
}

file_id =
{
    enable_type = true,
    enable_signature = true,
    type_depth = 104800,
    signature_depth = 0,
    show_data_depth = 1,
    block_timeout = 60,
    lookup_timeout = 30,
    file_rules = file_magic,
    --option change: 'config file: file_block_timeout' --> 'block_timeout'
    --option change: 'config file: file_lookup_timeout' --> 'lookup_timeout'
    --option change: 'config file: file_signature_depth' --> 'signature_depth'
    --option change: 'config file: file_type_depth' --> 'type_depth'
    --option change: 'config file: signature' --> 'enable_signature'
    --option change: 'config file: type_id' --> 'enable_type'
}

event_filter =
{
    {
        gid = 119,
        sid = 404,
        type = 'limit',
        track = 'by_src',
        count = 10,
        seconds = 20,
        --option change: 'gen_id' --> 'gid'
        --option change: 'sig_id' --> 'sid'
    },
    {
        type = 'limit',
        track = 'by_src',
        count = 1,
        seconds = 60,
        sid = 1000047,
        gid = 119,
    },
    {
        type = 'limit',
        track = 'by_src',
        count = 1,
        seconds = 60,
        sid = 1000048,
        gid = 1,
    },
    {
        type = 'limit',
        track = 'by_src',
        count = 1,
        seconds = 60,
        sid = 1000049,
        gid = 1,
    },
    {
        type = 'limit',
        track = 'by_src',
        count = 1,
        seconds = 60,
        sid = 1000050,
        gid = 1,
    },
    {
        type = 'limit',
        track = 'by_src',
        count = 1,
        seconds = 60,
        gid = 1,
        sid = 1000051,
    },
    {
        gid = 1,
        sid = 7037,
        type = 'limit',
        track = 'by_src',
        count = 1,
        seconds = 60,
        --option change: 'gen_id' --> 'gid'
        --option change: 'sig_id' --> 'sid'
    },
    --option change: 'ips_option: threshold' --> 'event_filter'
    --option change: 'threshold' --> 'event_filter'
}

rate_filter =
{
    {
        gid = 119,
        sid = 404,
        track = 'by_src',
        count = 10,
        seconds = 20,
        timeout = 50,
        new_action = 'block',
        apply_to = '[[2.3.4.5/24],!3.3.4.5/24]',
        --option change: 'gen_id' --> 'gid'
        --option change: 'sig_id' --> 'sid'
    },
}

search_engine =
{
    search_method = 'ac_full',
    search_optimize = true,
    max_pattern_len = 20,
    detect_raw_tcp = false,
    max_queue_events = 21,
    enable_single_rule_group = true,
    max_pattern_len = 22,
    debug_print_nocontent_rule_tests = true,
    debug_print_rule_group_build_details = true,
    split_any_any = true,
    search_method = 'ac_bnfa',
    debug_print_rule_groups_compiled = true,
    debug_print_rule_groups_uncompiled = true,
    bleedover_warnings_enabled = true,
    show_fast_patterns = true,
    search_method = 'lowmem',
    debug = true,
    search_method = 'ac_banded',
    search_method = 'ac_std',
    search_method = 'ac_sparse',
    search_method = 'ac_sparse_bands',
    --This table was previously 'config detection: ...
    --option change: 'ac' --> 'ac_full'
    --option change: 'ac-banded' --> 'ac_banded'
    --option change: 'ac-bnfa' --> 'ac_bnfa'
    --option change: 'ac-bnfa-nq' --> 'ac_bnfa'
    --option change: 'ac-bnfa-q' --> 'ac_bnfa'
    --option change: 'ac-nq' --> 'ac_full'
    --option change: 'ac-q' --> 'ac_full'
    --option change: 'ac-sparsebands' --> 'ac_sparse_bands'
    --option change: 'ac-split' --> 'ac_full'
    --option change: 'ac-split' --> 'split_any_any'
    --option change: 'ac-std' --> 'ac_std'
    --option change: 'acs' --> 'ac_sparse'
    --option change: 'bleedover-port-limit' --> 'bleedover_port_limit'
    --option change: 'bleedover-warnings-enabled' -->
    --    'bleedover_warnings_enabled'
    --option change: 'debug-print-fast-pattern' --> 'show_fast_patterns'
    --option change: 'debug-print-nocontent-rule-tests' -->
    --    'debug_print_nocontent_rule_tests'
    --option change: 'debug-print-rule-group-build-details' -->
    --    'debug_print_rule_group_build_details'
    --option change: 'debug-print-rule-groups-compiled' -->
    --    'debug_print_rule_groups_compiled'
    --option change: 'debug-print-rule-groups-uncompiled' -->
    --    'debug_print_rule_groups_uncompiled'
    --option change: 'enable-single-rule-group' --> 'enable_single_rule_group'
    --option change: 'lowmem-nq' --> 'lowmem'
    --option change: 'lowmem-q' --> 'lowmem'
    --option change: 'max-pattern-len' --> 'max_pattern_len'
    --option change: 'no_stream_inserts' --> 'detect_raw_tcp'
    --option change: 'search-method' --> 'search_method'
    --option change: 'search-optimize' --> 'search_optimize'
    --option change: 'split-any-any' --> 'split_any_any'
    --option deleted: 'mwm'
}

event_queue =
{
    max_queue = 8,
    log = 5,
    order_events = 'content_length',
    process_all_events = true,
}

hosts =
{
    {
        ip = '10.4.11.1',
        frag_policy = 'bsd',
        tcp_policy = 'bsd',
    },
    {
        ip = '10.4.11.2',
        --option deleted: '<FRAG_POLICY>unknown</FRAG_POLICY>'
        --option deleted: '<STREAM_POLICY>unknown</STREAM_POLICY>'
    },
    {
        ip = '10.4.11.3',
        tcp_policy = 'hpux11',
        --option deleted: '<FRAG_POLICY>hpux</FRAG_POLICY>'
    },
    {
        ip = '10.4.11.4',
        tcp_policy = 'irix',
        --option deleted: '<FRAG_POLICY>irix</FRAG_POLICY>'
    },
    {
        ip = '10.4.11.5',
        frag_policy = 'last',
        tcp_policy = 'last',
    },
    {
        ip = '10.4.11.6',
        tcp_policy = 'old_linux',
        --option change: '<STREAM_POLICY>old-linux</STREAM_POLICY>' -->
        --    'hosts.tcp_policy = old_linux'
        --option deleted: '<FRAG_POLICY>old-linux</FRAG_POLICY>'
    },
    {
        ip = '10.4.11.7',
        frag_policy = 'linux',
        tcp_policy = 'linux',
    },
    {
        ip = '10.4.11.8',
        frag_policy = 'solaris',
        tcp_policy = 'solaris',
    },
    {
        ip = '10.4.11.9',
        frag_policy = 'windows',
        tcp_policy = 'windows',
    },
    {
        ip = '10.4.11.10',
        frag_policy = 'bsd_right',
        tcp_policy = 'hpux11',
        --option change: '<FRAG_POLICY>bsd-right</FRAG_POLICY>' -->
        --    'hosts.frag_policy = bsd_right'
        --option change: '<STREAM_POLICY>hpux</STREAM_POLICY>' -->
        --    'hosts.tcp_policy = hpux11'
    },
    {
        ip = '10.4.12.226',
        frag_policy = 'windows',
        tcp_policy = 'windows',
        services =
        {
            {
                port = 80,
                proto = 'tcp',
                name = 'smtp',
            },
        },
    },
    {
        ip = '10.4.12.227',
        frag_policy = 'linux',
        tcp_policy = 'linux',
        services =
        {
            {
                port = 8001,
                proto = 'tcp',
                name = 'http',
            },
            {
                port = 80,
                proto = 'tcp',
                name = 'smtp',
            },
        },
    },
    {
        ip = '10.4.12.228',
        frag_policy = 'windows',
        tcp_policy = 'last',
    },
    {
        ip = '10.4.12.229',
        frag_policy = 'windows',
        tcp_policy = 'old_linux',
        --option change: '<STREAM_POLICY>old-linux</STREAM_POLICY>' -->
        --    'hosts.tcp_policy = old_linux'
    },
    {
        ip = '10.4.12.230',
        frag_policy = 'windows',
        tcp_policy = 'vista',
    },
    {
        ip = '10.4.12.231',
        frag_policy = 'windows',
        tcp_policy = 'win_2003',
        --option change: '<STREAM_POLICY>win-2003</STREAM_POLICY>' -->
        --    'hosts.tcp_policy = win_2003'
    },
    {
        ip = '10.4.12.232',
        frag_policy = 'windows',
        tcp_policy = 'macos',
    },
    --option change: 'STREAM_POLICY' --> 'hosts: tcp_policy'
    --option change: 'filename <file_name>' --> 'hosts[]'
}

latency =
{
    packet =
    {
        max_time = 250,
        fastpath = true,
    },
    rule =
    {
        max_time = 200,
        suspend_threshold = 3,
        suspend = true,
        max_suspend_time = 20000,
        --option change: 'suspend-timeout' --> 'max_suspend_time'
        --seconds changed to milliseconds
    },
    --option change: 'fastpath-expensive-packets' --> 'packet.fastpath'
    --option change: 'max-pkt-time' --> 'packet.max_time'
    --option change: 'max-rule-time' --> 'rule.max_time'
    --option change: 'ppm' --> 'latency'
    --option change: 'suspend-expensive-rules' --> 'rule.suspend'
    --option change: 'suspend-timeout' --> 'max_suspend_time'
    --option change: 'threshold' --> 'rule.suspend_threshold'
    --option deleted: 'debug-pkts'
    --option deleted: 'pkt-log'
    --option deleted: 'rule-log'
}

profiler =
{
    modules =
    {
        count = 2,
        sort = 'total_time',
        --option change: 'print' --> 'count'
        --option change: 'sort avg_ticks' --> 'sort = avg_check'
        --option change: 'sort total_ticks' --> 'sort = total_time'
        --option deleted: 'profile_*: filename ...'
    },
    rules =
    {
        sort = 'avg_check',
        show = false,
        count = 1,
        --option change: 'print' --> 'count'
        --option change: 'sort avg_ticks' --> 'sort = avg_check'
        --option change: 'sort avg_ticks_per_match' --> 'sort = avg_match'
        --option change: 'sort avg_ticks_per_nomatch' --> 'sort = avg_no_match'
        --option change: 'sort nomatches' --> 'sort = no_matches'
        --option change: 'sort total_ticks' --> 'sort = total_time'
        --option deleted: 'profile_*: filename ...'
    },
}
profiler.modules.sort = 'checks'
profiler.modules.sort = 'avg_check'
profiler.modules.sort = 'total_time'
profiler.rules.sort = 'checks'
profiler.rules.sort = 'total_time'
profiler.rules.sort = 'matches'
profiler.rules.sort = 'no_matches'
profiler.rules.sort = 'avg_match'
profiler.rules.sort = 'avg_no_match'
profiler.rules.count = 2
profiler.rules.show = true
profiler.rules.count = 3


gtp_inspect =
{
    --option change: 'ports' --> 'bindings'
}

stream_ip =
{
    max_frags = 8193,
    policy = 'last',
    policy = 'bsd',
    policy = 'linux',
    policy = 'solaris',
    max_overlaps = 10,
    min_frag_length = 100,
    session_timeout = 256,
    session_timeout = 180,
    min_ttl = 2,
    --option change: 'min_fragment_length' --> 'min_frag_length'
    --option change: 'overlap_limit' --> 'max_overlaps'
    --option change: 'preprocessor frag3_engine: timeout 0' -->
    --    'session_timeout 256'
    --option change: 'timeout' --> 'session_timeout'
    --option deleted: 'detect_anomalies'
    --option deleted: 'disabled'
    --option deleted: 'memcap'
    --option deleted: 'prealloc_frags'
    --option deleted: 'prealloc_memcap'
}

stream_ip_0 =
{
    policy = 'last',
    policy = 'bsd',
    policy = 'bsd_right',
    policy = 'first',
    policy = 'windows',
    policy = 'linux',
    policy = 'solaris',
    max_overlaps = 10,
    min_frag_length = 100,
    session_timeout = 256,
    session_timeout = 180,
    min_ttl = 2,
    --option change: 'min_fragment_length' --> 'min_frag_length'
    --option change: 'overlap_limit' --> 'max_overlaps'
    --option change: 'policy bsd-right' --> 'policy = bsd_right'
    --option change: 'preprocessor frag3_engine: timeout 0' -->
    --    'session_timeout 256'
    --option change: 'timeout' --> 'session_timeout'
    --option deleted: 'detect_anomalies'
}

stream_ip_1 =
{
    policy = 'last',
    policy = 'bsd',
    policy = 'linux',
    policy = 'solaris',
    max_overlaps = 10,
    min_frag_length = 100,
    session_timeout = 256,
    session_timeout = 180,
    min_ttl = 2,
    --option change: 'min_fragment_length' --> 'min_frag_length'
    --option change: 'overlap_limit' --> 'max_overlaps'
    --option change: 'preprocessor frag3_engine: timeout 0' -->
    --    'session_timeout 256'
    --option change: 'timeout' --> 'session_timeout'
    --option deleted: 'detect_anomalies'
}

stream =
{
    max_flows = 456669,
    pruning_timeout = 120,
    footprint = 192,
    tcp_cache =
    {
        idle_timeout = 180,
        --option change: 'tcp_cache_nominal_timeout' --> 'idle_timeout'
    },
    udp_cache =
    {
        idle_timeout = 181,
        --option change: 'udp_cache_nominal_timeout' --> 'idle_timeout'
    },
    --option deleted: 'disabled'
    --option deleted: 'flush_on_alert'
    --option deleted: 'memcap'
    --option deleted: 'prune_log_max'
    --option deleted: 'track_icmp'
    --option deleted: 'track_ip'
    --option deleted: 'track_tcp'
    --option deleted: 'track_udp'
}

active =
{
    max_responses = 2,
    min_interval = 5,
    --option change: 'max_active_responses' --> 'max_responses'
    --option change: 'min_response_seconds' --> 'min_interval'
}

reject =
{
    reset = 'both',
    reset = 'source',
    reset = 'dest',
    control = 'network',
    control = 'host',
    control = 'port',
    control = 'all',
    --option change: 'rule_type - resp:icmp_all' --> 'reject - control: all'
    --option change: 'rule_type - resp:icmp_host' --> 'reject - control: host'
    --option change: 'rule_type - resp:icmp_net' --> 'reject - control:
    --    network'
    --option change: 'rule_type - resp:icmp_port' --> 'reject - control: port'
    --option change: 'rule_type - resp:reset_both' --> 'reject - reset: both'
    --option change: 'rule_type - resp:reset_dest' --> 'reject - reset: dest'
    --option change: 'rule_type - resp:reset_source' --> 'reject - reset:
    --    source'
    --option change: 'rule_type - resp:rst_all' --> 'reject - reset: both'
    --option change: 'rule_type - resp:rst_rcv' --> 'reject - reset: dest'
    --option change: 'rule_type - resp:rst_snd' --> 'reject - reset: source'
}

stream_udp =
{
    session_timeout = 180,
    --option change: 'timeout' --> 'session_timeout'
    --option deleted: 'ignore_any_rules'
}

perf_monitor =
{
    base = true,
    cpu = true,
    flow = true,
    output = 'file',
    format = 'csv',
    max_file_size = 210000000,
    seconds = 300,
    packets = 10000,
    flow_ports = 1021,
    flow_ip = true,
    --option change: 'console' --> 'format = 'text''
    --option change: 'console' --> 'output = 'console''
    --option change: 'file' --> 'format = 'csv''
    --option change: 'file' --> 'output = 'file''
    --option change: 'flow-file' --> 'format = 'csv''
    --option change: 'flow-file' --> 'output = 'file''
    --option change: 'flow-ip' --> 'flow_ip'
    --option change: 'flow-ip-file' --> 'format = 'csv''
    --option change: 'flow-ip-file' --> 'output = 'file''
    --option change: 'flow-ports' --> 'flow_ports'
    --option change: 'pktcnt' --> 'packets'
    --option change: 'time' --> 'seconds'
    --option deleted: 'accumulate'
    --option deleted: 'atexitonly'
    --option deleted: 'atexitonly: base-stats'
    --option deleted: 'atexitonly: events-stats'
    --option deleted: 'atexitonly: flow-ip-stats'
    --option deleted: 'atexitonly: flow-stats'
    --option deleted: 'events'
    --option deleted: 'max'
}

http_inspect =
{
    iis_unicode_map_file = './unicode.map',
    iis_unicode_code_page = 1252,
    --http_methods = 'GET POST PUT SEARCH MKCOL COPY MOVE LOCK UNLOCK NOTIFY POLL BCOPY BDELETE BMOVE LINK UNLINK OPTIONS HEAD DELETE TRACE TRACK CONNECT SOURCE SUBSCRIBE UNSUBSCRIBE PROPFIND PROPPATCH BPROPFIND BPROPPATCH RPC_CONNECT PROXY_SUCCESS BITS_POST CCM_POST SMS_POST RPC_IN_DATA RPC_OUT_DATA RPC_ECHO_DATA',
    response_depth = 0,
    response_depth = -1,
    request_depth = -1,
    oversize_dir_length = 500,
    --ports = '80 81 311 383 591 593 901 1220 1414 1741 1830 2301 2381 2809 3037 3128 3702 4343 4848 5250 6988 7000 7001 7144 7145 7510 7777 7779 8000 8008 8014 8028 8080 8085 8088 8090 8118 8123 8180 8181 8243 8280 8300 8800 8888 8899 9000 9060 9080 9090 9091 9443 9999 11371 34443 34444 41080 50002 55555',
    unzip = true,
    normalize_utf = true,
    normalize_javascript = true,
    utf8_bare_byte = false,
    iis_double_decode = false,
    backslash_to_slash = false,
    iis_unicode = false,
    utf8 = false,
    percent_u = true,
    max_javascript_whitespaces = 199,
    --whitespace_chars = 'a b c',
    --decompress_pdf = 'deflate',
    decompress_pdf = true,
    --decompress_swf = 'lzma deflate',
    decompress_swf = true,
    simplify_path = true,
    bad_characters = '0x0 0x1 0x2 0x3 0x4 0x5 0x6 0x7',
    --option change: 'bare_byte' --> 'utf8_bare_byte'
    --option change: 'client_flow_depth' --> 'request_depth'
    --option change: 'directory' --> 'simplify_path'
    --option change: 'double_decode' --> 'iis_double_decode'
    --option change: 'flow_depth' --> 'response_depth'
    --option change: 'http_inspect_server' --> 'http_inspect'
    --option change: 'iis_backslash' --> 'backslash_to_slash'
    --option change: 'inspect_gzip' --> 'unzip'
    --option change: 'multi_slash' --> 'simplify_path'
    --option change: 'non_rfc_char' --> 'bad_characters'
    --option change: 'server_flow_depth' --> 'response_depth'
    --option change: 'u_encode' --> 'percent_u'
    --option change: 'utf_8' --> 'utf8'
    --option deleted: 'allow_proxy_use'
    --option deleted: 'apache_whitespace'
    --option deleted: 'ascii'
    --option deleted: 'b64_decode_depth'
    --option deleted: 'bitenc_decode_depth'
    --option deleted: 'chunk_length'
    --option deleted: 'compress_depth'
    --option deleted: 'decompress_depth'
    --option deleted: 'detect_anomalous_servers'
    --option deleted: 'disabled'
    --option deleted: 'enable_cookie'
    --option deleted: 'enable_xff'
    --option deleted: 'extended_ascii_uri'
    --option deleted: 'extended_response_inspection'
    --option deleted: 'iis_delimiter'
    --option deleted: 'iis_unicode_map not allowed in sever'
    --option deleted: 'inspect_uri_only'
    --option deleted: 'log_hostname'
    --option deleted: 'log_uri'
    --option deleted: 'max_gzip_mem'
    --option deleted: 'max_header_length'
    --option deleted: 'max_headers'
    --option deleted: 'max_mime_mem'
    --option deleted: 'max_spaces'
    --option deleted: 'memcap'
    --option deleted: 'no_alerts'
    --option deleted: 'no_pipeline_req'
    --option deleted: 'non_strict'
    --option deleted: 'normalize_cookies'
    --option deleted: 'normalize_headers'
    --option deleted: 'post_depth'
    --option deleted: 'proxy_alert'
    --option deleted: 'qp_decode_depth'
    --option deleted: 'small_chunk_length'
    --option deleted: 'tab_uri_delimiter'
    --option deleted: 'unlimited_decompress'
    --option deleted: 'uu_decode_depth'
    --option deleted: 'webroot'
}

http_inspect_0 =
{
    --ports = '80 8080 8180',
    oversize_dir_length = 200,
    --option deleted: 'enable_cookie'
    --option deleted: 'normalize_cookies'
    --option deleted: 'normalize_headers'
    --option deleted: 'profile'
}

rpc_decode =
{
    --option deleted: 'alert_fragments'
    --option deleted: 'no_alert_incomplete'
    --option deleted: 'no_alert_large_fragments'
    --option deleted: 'no_alert_multiple_requests'
}

bo =
{
}

telnet =
{
    encrypted_traffic = false,
    check_encrypted = true,
    ayt_attack_thresh = 20,
    normalize = true,
    --ports = '23',
    --option deleted: 'detect_anomalies'
    --option deleted: 'inspection_type'
}

ftp_server =
{
    encrypted_traffic = false,
    check_encrypted = true,
    def_max_param_len = 100,
    --ports = '21 2100 3535',
    telnet_cmds = false,
    print_cmds = true,
    ignore_telnet_erase_cmds = true,
    ignore_data_chan = true,
    chk_str_fmt = ftp_format_commands,
    data_chan_cmds = ftp_default_data_chan_cmds,
    data_xfer_cmds = ftp_default_data_xfer_cmds,
    encr_cmds = ftp_default_encr_cmds,
    file_get_cmds = ftp_default_file_get_cmds,
    file_put_cmds = ftp_default_file_put_cmds,
    login_cmds = ftp_default_login_cmds,
    ftp_cmds = BLAH1 .. [[ ABOR ACCT ADAT ALLO APPE AUTH CCC CDUP CEL CLNT
        CMD CONF CWD DELE ENC EPRT EPSV ESTA ESTP FEAT HELP LANG LIST LPRT
        LPSV MACB MAIL MDTM MIC MKD MLSD MLST MODE NLST NOOP OPTS PASS PASV
        PBSZ PORT PROT PWD QUIT REIN REST RETR RMD RNFR RNTO SDUP SITE SIZE
        SMNT STAT STOR STOU STRU SYST TEST TYPE USER XCRC XCUP XCWD XMAS XMD5
        XMKD XPWD XRCP XRMD XRSQ XSEM XSEN XSHA1 XSHA256 ]],
    cmd_validity =
    {
        {
            command = 'ABOR',
            length = 0,
        },
        {
            command = 'CCC',
            length = 0,
        },
        {
            command = 'CDUP',
            length = 0,
        },
        {
            command = 'ESTA',
            length = 0,
        },
        {
            command = 'FEAT',
            length = 0,
        },
        {
            command = 'LPSV',
            length = 0,
        },
        {
            command = 'NOOP',
            length = 0,
        },
        {
            command = 'PASV',
            length = 0,
        },
        {
            command = 'PWD',
            length = 0,
        },
        {
            command = 'QUIT',
            length = 0,
        },
        {
            command = 'REIN',
            length = 0,
        },
        {
            command = 'SYST',
            length = 0,
        },
        {
            command = 'XCUP',
            length = 0,
        },
        {
            command = 'XPWD',
            length = 0,
        },
        {
            command = 'APPE',
            length = 200,
        },
        {
            command = 'CMD',
            length = 200,
        },
        {
            command = 'HELP',
            length = 200,
        },
        {
            command = 'NLST',
            length = 200,
        },
        {
            command = 'RETR',
            length = 200,
        },
        {
            command = 'RNFR',
            length = 200,
        },
        {
            command = 'STOR',
            length = 200,
        },
        {
            command = 'STOU',
            length = 200,
        },
        {
            command = 'XMKD',
            length = 200,
        },
        {
            command = 'CWD',
            length = 256,
        },
        {
            command = 'RNTO',
            length = 256,
        },
        {
            command = 'SIZE',
            length = 512,
        },
        {
            command = 'ALLO',
            length = 200,
            format = '< int [ char R int ] >',
        },
        {
            command = 'PORT',
            length = 400,
            format = '< host_port >',
        },
        {
            command = 'LPRT',
            length = 400,
            format = '< long_host_port >',
        },
        {
            command = 'EPRT',
            length = 400,
            format = '< extd_host_port >',
        },
        {
            command = 'EPSV',
            format = '< [ { char 12 | char A char L char L } ] >',
        },
        {
            command = 'MACB',
            format = '< string >',
        },
        {
            command = 'MDTM',
            length = 256,
            format = '< [ date nnnnnnnnnnnnnn[.n[n[n]]] ] string >',
        },
        {
            command = 'MODE',
            format = '< char ASBCZ >',
        },
        {
            command = 'PROT',
            format = '< char CSEP >',
        },
        {
            command = 'STRU',
            format = '< char FRPO [ string ] >',
        },
        {
            command = 'TYPE',
            format = [[ < { char AE [ char NTC ] | char I | char L [ number ]
                } > ]],
        },
        {
            command = 'MDTM',
            length = 256,
            format = '< [ date nnnnnnnnnnnnnn[.n[n[n[.n]]]] ] string >',
        },
        --option change: 'alt_max_param_len' --> 'cmd_validity'
    },
    --option change: 'data_chan' --> 'ignore_data_chan'
    --option deleted: 'inspection_type'
}

ftp_data =
{
}

ftp_client =
{
    max_resp_len = 256,
    bounce = true,
    ignore_telnet_erase_cmds = true,
    telnet_cmds = true,
    bounce_to =
    {
        {
            address = '192.168.1.1',
            port = 20020,
        },
        {
            address = '192.168.1.2',
            port = 20020,
            last_port = 20040,
        },
        {
            address = 'fe8::5',
            port = 59340,
        },
        {
            address = '192.168.1.3',
            port = 20020,
        },
        {
            address = '192.168.1.4',
            port = 20030,
        },
    },
}

ftp_client_target_1 =
{
    bounce = true,
}

ftp_client_target_2 =
{
    bounce = true,
}

ftp_server_target_1 =
{
    def_max_param_len = 100,
    telnet_cmds = true,
    ignore_data_chan = true,
    chk_str_fmt = ftp_format_commands,
    data_chan_cmds = ftp_default_data_chan_cmds,
    data_xfer_cmds = ftp_default_data_xfer_cmds,
    encr_cmds = ftp_default_encr_cmds,
    file_get_cmds = ftp_default_file_get_cmds,
    file_put_cmds = ftp_default_file_put_cmds,
    ftp_cmds = ftp_default_cmds,
    login_cmds = ftp_default_login_cmds,
    cmd_validity = ftp_command_specs,
    --option change: 'data_chan' --> 'ignore_data_chan'
}

smtp =
{
    --ports = '25 465 587 691',
    b64_decode_depth = -1,
    qp_decode_depth = -1,
    bitenc_decode_depth = -1,
    uu_decode_depth = -1,
    log_mailfrom = true,
    log_rcptto = true,
    log_filename = true,
    log_email_hdrs = true,
    normalize = 'cmds',
    max_command_line_len = 512,
    max_header_line_len = 1000,
    max_response_line_len = 512,
    xlink2state = 'alert',
    normalize_cmds = [[ ATRN AUTH BDAT CHUNKING DATA DEBUG EHLO EMAL ESAM
        ESND ESOM ETRN EVFY EXPN HELO HELP IDENT MAIL NOOP ONEX QUEU QUIT
        RCPT RSET SAML SEND SOML X-EXPS X-LINK2STATE XADR XAUTH XCIR XEXCH50
        XGEN XLICENSE XQUE XSTA XTRN XUSR ]],
    valid_cmds = [[ ATRN AUTH BDAT CHUNKING DATA DEBUG EHLO EMAL ESAM ESND
        ESOM ETRN EVFY EXPN HELO HELP IDENT MAIL NOOP ONEX QUEU QUIT RCPT
        RSET SAML SEND SOML STARTTLS TICK TIME TURN TURNME VERB VRFY X-ADAT
        X-DRCP X-ERCP X-EXCH50 X-EXPS X-LINK2STATE XADR XAUTH XCIR XEXCH50
        XGEN XLICENSE XQUE XSTA XTRN XUSR ]],
    alt_max_command_line_len =
    {
        {
            command = 'MAIL',
            length = 260,
        },
        {
            command = 'RCPT',
            length = 300,
        },
        {
            command = 'HELP',
            length = 500,
        },
        {
            command = 'HELO',
            length = 500,
        },
        {
            command = 'ETRN',
            length = 500,
        },
        {
            command = 'EHLO',
            length = 500,
        },
        {
            command = 'EXPN',
            length = 255,
        },
        {
            command = 'VRFY',
            length = 255,
        },
        {
            command = 'ATRN',
            length = 255,
        },
        {
            command = 'SIZE',
            length = 255,
        },
        {
            command = 'BDAT',
            length = 255,
        },
        {
            command = 'DEBUG',
            length = 255,
        },
        {
            command = 'EMAL',
            length = 255,
        },
        {
            command = 'ESAM',
            length = 255,
        },
        {
            command = 'ESND',
            length = 255,
        },
        {
            command = 'ESOM',
            length = 255,
        },
        {
            command = 'EVFY',
            length = 255,
        },
        {
            command = 'IDENT',
            length = 255,
        },
        {
            command = 'NOOP',
            length = 255,
        },
        {
            command = 'RSET',
            length = 255,
        },
        {
            command = 'SEND',
            length = 246,
        },
        {
            command = 'SAML',
            length = 246,
        },
        {
            command = 'SOML',
            length = 246,
        },
        {
            command = 'AUTH',
            length = 246,
        },
        {
            command = 'TURN',
            length = 246,
        },
        {
            command = 'DATA',
            length = 246,
        },
        {
            command = 'QUIT',
            length = 246,
        },
        {
            command = 'ONEX',
            length = 246,
        },
        {
            command = 'QUEU',
            length = 246,
        },
        {
            command = 'STARTTLS',
            length = 246,
        },
        {
            command = 'TICK',
            length = 246,
        },
        {
            command = 'TIME',
            length = 246,
        },
        {
            command = 'TURNME',
            length = 246,
        },
        {
            command = 'VERB',
            length = 246,
        },
        {
            command = 'X-EXPS',
            length = 246,
        },
        {
            command = 'X-LINK2STATE',
            length = 246,
        },
        {
            command = 'XADR',
            length = 246,
        },
        {
            command = 'XAUTH',
            length = 246,
        },
        {
            command = 'XCIR',
            length = 246,
        },
        {
            command = 'XEXCH50',
            length = 246,
        },
        {
            command = 'XGEN',
            length = 246,
        },
        {
            command = 'XLICENSE',
            length = 246,
        },
        {
            command = 'XQUE',
            length = 246,
        },
        {
            command = 'XSTA',
            length = 246,
        },
        {
            command = 'XTRN',
            length = 246,
        },
        {
            command = 'XUSR',
            length = 246,
        },
    },
    --option deleted: 'inspection_type'
    --option deleted: 'no_alerts'
}

port_scan =
{
    memcap = 10000000,
    watch_ip = '[!1.2.3.4,1.2.3.5,1.2.3.6]',
    ignore_scanned = '[[[2.3.4.5/24 6000],!3.3.4.5/24 7000-8000]]',
    ignore_scanners = '[!4.5.6.7/8 9-10]',
    include_midstream = true,
    protos = 'tcp udp icmp ip all all',
    scan_types = 'portscan portsweep decoy_portscan distributed_portscan all',
    --option change: 'proto' --> 'protos'
    --option change: 'scan_type' --> 'scan_types'
    --option deleted: 'detect_ack_scans'
    --option deleted: 'disabled'
    --option deleted: 'logfile'
    --option deleted: 'sense_level'
}

arp_spoof =
{
    hosts =
    {
        {
            ip = '192.168.40.1',
            mac = 'f0:0f:00:f0:0f:00',
        },
        {
            ip = '192.168.40.2',
            mac = 'f0:0f:00:f0:0f:00',
        },
        {
            ip = '192.168.40.3',
            mac = 'f0:0f:00:f0:0f:00',
        },
    },
    --option deleted: 'unicast'
}

ssh =
{
    --server_ports = '22',
    max_client_bytes = 19600,
    max_encrypted_packets = 20,
    max_server_version_len = 100,
    --option deleted: 'autodetect'
    --option deleted: 'enable_protomismatch'
    --option deleted: 'enable_respoverflow'
    --option deleted: 'enable_srvoverflow'
    --option deleted: 'enable_ssh1crc32'
}

dns =
{
    --option change: 'ports' --> 'bindings'
    --option deleted: 'enable_rdata_overflow'
}

ssl =
{
    --ports = '443',
    trust_servers = true,
    --option deleted: 'noinspect_encrypted'
}

sip =
{
    --ports = '5060 5061 5600',
    max_uri_len = 512,
    max_call_id_len = 80,
    max_requestName_len = 20,
    max_from_len = 256,
    max_to_len = 256,
    max_via_len = 1024,
    max_contact_len = 512,
    max_content_len = 2048,
    methods = [[ invite cancel ack bye register options refer subscribe
        update join info message notify benotify do qauth sprack publish
        service unsubscribe prack ]],
    --option deleted: 'max_sessions'
}

imap =
{
    --ports = '143',
    b64_decode_depth = -1,
    qp_decode_depth = -1,
    bitenc_decode_depth = -1,
    uu_decode_depth = -1,
}

pop =
{
    --ports = '110',
    b64_decode_depth = -1,
    qp_decode_depth = -1,
    bitenc_decode_depth = -1,
    uu_decode_depth = -1,
}

modbus =
{
    --option change: 'ports' --> 'bindings'
}

dnp3 =
{
    --ports = '20000',
    check_crc = true,
    --option deleted: 'memcap'
}

reputation =
{
    memcap = 500,
    priority = 'allowlist',
    nested_ip = 'inner',
    allowlist = WHITE_LIST_PATH .. '/white_list.rules',
    blocklist = BLACK_LIST_PATH .. '/black_list.rules',
}

unified2 =
{
    limit = 128,
    nostamp = true,
    --option change: 'output unified2' --> 'unified2'
    --option deleted: 'filename'
    --option deleted: 'mpls_event_types'
    --option deleted: 'vlan_event_types'
}

alert_syslog =
{
    facility = 'auth',
    level = 'alert',
    options = 'pid',
    level = 'emerg',
    options = 'cons',
    facility = 'authpriv',
    facility = 'daemon',
    level = 'crit',
    options = 'ndelay',
    facility = 'local0',
    level = 'err',
    facility = 'local1',
    level = 'warning',
    options = 'perror',
    facility = 'local2',
    level = 'notice',
    facility = 'local3',
    level = 'info',
    facility = 'local4',
    level = 'debug',
    facility = 'local5',
    facility = 'local6',
    facility = 'local7',
    facility = 'user',
    --BINDINGS REQUIRED!! hostname --> --> HOST=10.1.1.3:514
    --BINDINGS REQUIRED!! hostname --> --> host=10.1.1.1:514,
    --BINDINGS REQUIRED!! hostname --> --> host=10.1.1.2:514,
    --BINDINGS REQUIRED!! hostname --> --> host=10.1.1.3:514,
    --option change: 'log_alert' --> 'level = alert'
    --option change: 'log_auth' --> 'facility = auth'
    --option change: 'log_authpriv' --> 'facility = authpriv'
    --option change: 'log_cons' --> 'options = cons'
    --option change: 'log_crit' --> 'level = crit'
    --option change: 'log_daemon' --> 'facility = daemon'
    --option change: 'log_debug' --> 'level = debug'
    --option change: 'log_emerg' --> 'level = emerg'
    --option change: 'log_err' --> 'level = err'
    --option change: 'log_info' --> 'level = info'
    --option change: 'log_local0' --> 'facility = local0'
    --option change: 'log_local1' --> 'facility = local1'
    --option change: 'log_local2' --> 'facility = local2'
    --option change: 'log_local3' --> 'facility = local3'
    --option change: 'log_local4' --> 'facility = local4'
    --option change: 'log_local5' --> 'facility = local5'
    --option change: 'log_local6' --> 'facility = local6'
    --option change: 'log_local7' --> 'facility = local7'
    --option change: 'log_ndelay' --> 'options = ndelay'
    --option change: 'log_notice' --> 'level = notice'
    --option change: 'log_perror' --> 'options = perror'
    --option change: 'log_pid' --> 'options = pid'
    --option change: 'log_user' --> 'facility = user'
    --option change: 'log_warning' --> 'level = warning'
}

log_tcpdump =
{
    limit = 1,
    limit = 500,
    limit = 512000,
    limit = 501,
    limit = 513024,
    --limit now in MB, converted
    --option deleted: '<filename> can no longer be specific'
    --option deleted: 'units'
}

alert_fast =
{
    packet = true,
    limit = 1,
    limit = 53248,
    packet = false,
    limit = 53,
    --limit now in MB, converted
    --option deleted: '<filename> can no longer be specific'
    --option deleted: 'units'
}

alert_full =
{
    limit = 1,
    limit = 53,
    limit = 55296,
    --limit now in MB, converted
    --option deleted: '<filename> can no longer be specific'
    --option deleted: 'units'
}

alert_unixsock =
{
}

alert_csv =
{
    limit = 1,
    limit = 65,
    limit = 67584,
    fields = [[ timestamp gid sid rev msg proto src_addr src_port dst_addr
        dst_port eth_src eth_dst eth_len tcp_flags tcp_seq tcp_ack tcp_len
        tcp_win ttl tos ip_id pkt_len ip_len icmp_type icmp_code icmp_id
        icmp_seq eth_type udp_len icmp_type icmp_code icmp_id icmp_type
        icmp_code icmp_id icmp_type icmp_code icmp_id ]],
    --limit now in MB, converted
    --option change: 'csv' --> 'fields'
    --option change: 'dgmlen' --> 'pkt_len'
    --option change: 'dst' --> 'dst_addr'
    --option change: 'dstport' --> 'dst_port'
    --option change: 'ethdst' --> 'eth_dst'
    --option change: 'ethlen' --> 'eth_len'
    --option change: 'ethsrc' --> 'eth_src'
    --option change: 'ethtype' --> 'eth_type'
    --option change: 'icmpcode' --> 'icmp_code'
    --option change: 'icmpid' --> 'icmp_id'
    --option change: 'icmpseq' --> 'icmp_seq'
    --option change: 'icmptype' --> 'icmp_type'
    --option change: 'id' --> 'ip_id'
    --option change: 'iplen' --> 'ip_len'
    --option change: 'sig_generator' --> 'gid'
    --option change: 'sig_id' --> 'sid'
    --option change: 'sig_rev' --> 'rev'
    --option change: 'src' --> 'src_addr'
    --option change: 'srcport' --> 'src_port'
    --option change: 'tcpack' --> 'tcp_ack'
    --option change: 'tcpflags' --> 'tcp_flags'
    --option change: 'tcplen' --> 'tcp_len'
    --option change: 'tcpseq' --> 'tcp_seq'
    --option change: 'tcpwindow' --> 'tcp_win'
    --option change: 'udplength' --> 'udp_len'
    --option deleted: '<filename> can no longer be specific'
    --option deleted: 'default'
    --option deleted: 'units'
}

alert_null =
{
}

alert_test =
{
    session = true,
    rebuilt = true,
    msg = true,
    --option deleted: 'file'
    --option deleted: 'stdout'
}

classifications =
{
    {
        name = 'not-suspicious',
        text = 'Not Suspicious Traffic',
        priority = 3,
    },
    {
        name = 'unknown',
        text = 'Unknown Traffic',
        priority = 3,
    },
    {
        name = 'bad-unknown',
        text = 'Potentially Bad Traffic',
        priority = 2,
    },
    {
        name = 'attempted-recon',
        text = 'Attempted Information Leak',
        priority = 2,
    },
    {
        name = 'successful-recon-limited',
        text = 'Information Leak',
        priority = 2,
    },
    {
        name = 'successful-recon-largescale',
        text = 'Large Scale Information Leak',
        priority = 2,
    },
    {
        name = 'attempted-dos',
        text = 'Attempted Denial of Service',
        priority = 2,
    },
    {
        name = 'successful-dos',
        text = 'Denial of Service',
        priority = 2,
    },
    {
        name = 'attempted-user',
        text = 'Attempted User Privilege Gain',
        priority = 1,
    },
    {
        name = 'unsuccessful-user',
        text = 'Unsuccessful User Privilege Gain',
        priority = 1,
    },
    {
        name = 'successful-user',
        text = 'Successful User Privilege Gain',
        priority = 1,
    },
    {
        name = 'attempted-admin',
        text = 'Attempted Administrator Privilege Gain',
        priority = 1,
    },
    {
        name = 'successful-admin',
        text = 'Successful Administrator Privilege Gain',
        priority = 1,
    },
    {
        name = 'rpc-portmap-decode',
        text = 'Decode of an RPC Query',
        priority = 2,
    },
    {
        name = 'shellcode-detect',
        text = 'Executable code was detected',
        priority = 1,
    },
    {
        name = 'string-detect',
        text = 'A suspicious string was detected',
        priority = 3,
    },
    {
        name = 'suspicious-filename-detect',
        text = 'A suspicious filename was detected',
        priority = 2,
    },
    {
        name = 'suspicious-login',
        text = 'An attempted login using a suspicious username was detected',
        priority = 2,
    },
    {
        name = 'system-call-detect',
        text = 'A system call was detected',
        priority = 2,
    },
    {
        name = 'tcp-connection',
        text = 'A TCP connection was detected',
        priority = 4,
    },
    {
        name = 'trojan-activity',
        text = 'A Network Trojan was detected',
        priority = 1,
    },
    {
        name = 'unusual-client-port-connection',
        text = 'A client was using an unusual port',
        priority = 2,
    },
    {
        name = 'network-scan',
        text = 'Detection of a Network Scan',
        priority = 3,
    },
    {
        name = 'denial-of-service',
        text = 'Detection of a Denial of Service Attack',
        priority = 2,
    },
    {
        name = 'non-standard-protocol',
        text = 'Detection of a non-standard protocol or event',
        priority = 2,
    },
    {
        name = 'protocol-command-decode',
        text = 'Generic Protocol Command Decode',
        priority = 3,
    },
    {
        name = 'web-application-activity',
        text = 'access to a potentially vulnerable web application',
        priority = 2,
    },
    {
        name = 'web-application-attack',
        text = 'Web Application Attack',
        priority = 1,
    },
    {
        name = 'misc-activity',
        text = 'Misc activity',
        priority = 3,
    },
    {
        name = 'misc-attack',
        text = 'Misc Attack',
        priority = 2,
    },
    {
        name = 'icmp-event',
        text = 'Generic ICMP event',
        priority = 3,
    },
    {
        name = 'inappropriate-content',
        text = 'Inappropriate Content was Detected',
        priority = 1,
    },
    {
        name = 'policy-violation',
        text = 'Potential Corporate Privacy Violation',
        priority = 1,
    },
    {
        name = 'default-login-attempt',
        text = 'Attempt to login by a default username and password',
        priority = 2,
    },
    {
        name = 'sdf',
        text = 'Senstive Data',
        priority = 2,
    },
    {
        name = 'file-format',
        text = 'Known malicious file or file based exploit',
        priority = 1,
    },
    {
        name = 'malware-cnc',
        text = 'Known malware command and control traffic',
        priority = 1,
    },
    {
        name = 'client-side-exploit',
        text = 'Known client side exploit attempt',
        priority = 1,
    },
}

references =
{
    {
        name = 'bugtraq',
        url = 'http://www.securityfocus.com/bid/',
    },
    {
        name = 'cve',
        url = 'http://cve.mitre.org/cgi-bin/cvename.cgi?name=',
    },
    {
        name = 'arachNIDS',
        url = 'http://www.whitehats.com/info/IDS',
    },
    {
        name = 'osvdb',
        url = 'http://osvdb.org/show/osvdb/',
    },
    {
        name = 'McAfee',
        url = 'http://vil.nai.com/vil/content/v_',
    },
    {
        name = 'nessus',
        url = 'http://cgi.nessus.org/plugins/dump.php3?id=',
    },
    {
        name = 'url',
        url = 'http://',
    },
    {
        name = 'msb',
        url = 'http://technet.microsoft.com/en-us/security/bulletin/',
    },
}

ips =
{
    enable_builtin_rules = true,
    uuid = '11111111-1111-1111-1111-123456789012',
    mode = 'tap',
    obfuscate_pii = true,
    states = local_states,
    rules = local_rules,
    variables = local_variables,
    --option change: 'config autogenerate_preprocessor_decoder_rules:' -->
    --    'enable_builtin_rules'
}

network =
{
    min_ttl = 5,
    new_ttl = 8,
    max_ip6_extensions = 3,
    max_ip6_extensions = 9,
    checksum_eval = 'noip notcp noudp noicmp none all',
    checksum_drop = 'none noip notcp noicmp noudp ip tcp udp icmp all',
    --option change: 'checksum_mode' --> 'checksum_eval'
}

detection =
{
    asn1 = 111,
    global_default_rule_state = false,
    pcre_enable = false,
    pcre_match_limit = 3500,
    pcre_match_limit_recursion = 1500,
    global_rule_state = true,
    --option change: 'config nopcre:' --> 'pcre_enable'
}

stream_tcp =
{
    max_pdu = 32768,
    max_pdu = 1460,
    show_rebuilt_packets = true,
    policy = 'windows',
    require_3whs = 180,
    require_3whs = 0,
    overlap_limit = 10,
    max_window = 256,
    session_timeout = 180,
    reassemble_async = false,
    flush_factor = 10,
    policy = 'bsd',
    policy = 'first',
    policy = 'irix',
    policy = 'last',
    policy = 'linux',
    policy = 'macos',
    policy = 'old_linux',
    policy = 'solaris',
    policy = 'vista',
    policy = 'hpux11',
    policy = 'hpux10',
    policy = 'win_2003',
    small_segments =
    {
        count = 3,
        maximum_size = 160,
        maximum_size = 150,
        count = 5,
        maximum_size = 170,
    },
    queue_limit =
    {
        max_bytes = 4096,
        max_segments = 2048,
    },
    --option change: 'bind_to' --> 'bindings'
    --option change: 'both ports' --> 'binder.when.ports; binder.when.role =
    --    any'
    --option change: 'both protocol' --> 'binder.when.proto; binder.when.role =
    --    any'
    --option change: 'client ports' --> 'binder.when.ports; binder.when.role =
    --    client'
    --option change: 'dont_reassemble_async' --> 'reassemble_async'
    --option change: 'max_queued_bytes' --> 'queue_limit.max_bytes'
    --option change: 'max_queued_segs' --> 'queue_limit.max_segments'
    --option change: 'paf_max [0:63780]' --> 'max_pdu [1460:32768]'
    --option change: 'policy grannysmith' --> 'stream_tcp.policy = macos'
    --option change: 'policy hpux' --> 'stream_tcp.policy = hpux11'
    --option change: 'policy win2003' --> 'stream_tcp.policy = win_2003'
    --option change: 'policy win2k3' --> 'stream_tcp.policy = win_2003'
    --option change: 'server ports' --> 'binder.when.ports; binder.when.role =
    --    server'
    --option change: 'server protocol' --> 'binder.when.proto; binder.when.role
    --    = server'
    --option change: 'timeout' --> 'session_timeout'
    --option change: 'use_static_footprint_sizes' --> 'stream.footprint = 192'
    --option deleted: 'check_session_hijacking'
    --option deleted: 'detect_anomalies'
    --option deleted: 'dont_store_large_packets'
    --option deleted: 'ignore_any_rules'
    --option deleted: 'ignore_ports 33 44 55'
    --option deleted: 'ignore_ports 66 77'
    --option deleted: 'policy noack'
    --option deleted: 'policy unknown'
}

normalizer =
{
    icmp4 = true,
    ip6 = true,
    icmp6 = true,
    ip4 =
    {
        df = true,
        rf = true,
        tos = true,
        trim = true,
    },
    tcp =
    {
        ips = true,
        ecn = 'stream',
        ecn = 'packet',
        trim_rst = true,
        trim_syn = true,
        trim_mss = true,
        trim_win = true,
        opts = true,
        req_urg = true,
        req_pay = true,
        req_urp = true,
        urp = true,
        pad = true,
        rsv = true,
        block = true,
        allow_names = 'sack md5 conn_count echo partial_order alt_checksum',
        allow_codes = '17 18 19 20',
        --option deleted: 'trim'
    },
    --option change: 'preprocessor normalize_icmp4' --> 'icmp4 = <bool>'
    --option change: 'preprocessor normalize_icmp6' --> 'icmp6 = <bool>'
    --option change: 'preprocessor normalize_ip6' --> 'ip6 = <bool>'
}

suppress =
{
    {
        gid = 123,
        sid = 3,
    },
    {
        gid = 123,
        sid = 4,
    },
    {
        gid = 123,
        sid = 5,
    },
    {
        gid = 123,
        sid = 8,
        track = 'by_src',
        ip = '192.168.1.9/24',
    },
    {
        gid = 123,
        sid = 9,
        track = 'by_src',
        ip = '[192.168.1.9/24,192.168.1.10/24]',
    },
    --option change: 'gen_id' --> 'gid'
    --option change: 'sig_id' --> 'sid'
}

binder =
{
    { when = { proto = 'udp', ports = '1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 53 65530 65531 65532 65533 65534 65535', }, use = { action = 'allow', }, },
    { when = { proto = 'tcp', ports = '21 0 6667 6668 6669 6670 6671 1356 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14', }, use = { action = 'allow', }, },
    { when = { proto = 'udp', ports = '1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 53', }, use = { action = 'allow', }, },
    { when = { proto = 'tcp', ports = '21 6667 6668 6669 6670 6671 1356', }, use = { action = 'allow', }, },
    { when = { proto = 'tcp', role = 'server', ports = '111 32770 32771 32772 32773 32774 32775 32776 32777 32778 32779', }, use = { type = 'rpc_decode', }, },
    { when = { proto = 'udp', role = 'server', ports = '2123 3386 2152', }, use = { type = 'gtp_inspect', }, },
    { when = { proto = 'udp', role = 'server', ports = '53', }, use = { type = 'dns', }, },
    { when = { proto = 'tcp', role = 'server', ports = '53', }, use = { type = 'dns', }, },
    { when = { proto = 'tcp', role = 'server', ports = '502', }, use = { type = 'modbus', }, },
    { when = { ips_policy_id = 51, }, use = { file = './conf/./binding_policy.conf.lua', }, },
    { when = { vlans = '0 1 2 3 4 5 15 4090 4091 4092 4093 4094 4095', }, use = { file = './conf/.//binding_vlan.conf.lua', }, },
    { when = { service = 'ftp', nets = 'fe80::0219:b9ff:fe29:ffff:0a04:0b88/96 fe80::0219:b9ff:fe29:ffff:0a04:0b88', }, use = { type = 'ftp_server', name = 'ftp_server_target_1', }, },
    { when = { service = 'http', nets = '10.15.36.100/24 10.15.36.103', }, use = { type = 'http_inspect', name = 'http_inspect_0', }, },
    { when = { service = 'ftp', proto = 'tcp', }, use = { type = 'ftp_client', }, },
    { when = { service = 'dnp3', }, use = { type = 'dnp3', }, },
    { when = { service = 'ftp', }, use = { type = 'ftp_server', }, },
    { when = { service = 'ftp-data', }, use = { type = 'ftp_data', }, },
    { when = { service = 'http', }, use = { type = 'http_inspect', }, },
    { when = { service = 'imap', }, use = { type = 'imap', }, },
    { when = { service = 'pop3', }, use = { type = 'pop', }, },
    { when = { service = 'sip', }, use = { type = 'sip', }, },
    { when = { service = 'smtp', }, use = { type = 'smtp', }, },
    { when = { service = 'ssh', }, use = { type = 'ssh', }, },
    { when = { service = 'ssl', }, use = { type = 'ssl', }, },
    { when = { service = 'telnet', }, use = { type = 'telnet', }, },
    { when = { proto = 'ip', nets = '[10.1.47.0/24,172.16.8.0/24]', }, use = { type = 'stream_ip', name = 'stream_ip_1', }, },
    { when = { proto = 'ip', nets = '192.1.2.7/24', }, use = { type = 'stream_ip', name = 'stream_ip_0', }, },
    { when = { proto = 'tcp', nets = '10.4.11.91/24 10.4.11.91', }, use = { type = 'ftp_client', name = 'ftp_client_target_2', }, },
    { when = { proto = 'tcp', nets = '10.4.11.91/24 10.4.11.91', }, use = { type = 'ftp_client', name = 'ftp_client_target_1', }, },
    { when = { nets = '192.168.0.0/16 10.4.11.0/24', }, use = { file = './conf/./binding_net.conf.lua', }, },
    { use = { type = 'wizard', }, },
}

--[[    COMMENTS:
 These lines were commented in the configuration file:


    ##################################################
    Step #1: Set the network variables.
    ##################################################
    Setup the network addresses you are protecting
    Set up the external network addresses. Leave as "any" in most situations
    List of DNS servers on your network
    List of SMTP servers on your network
    List of web servers on your network
    List of sql servers on your network
    List of telnet servers on your network
    List of ssh servers on your network
    List of ftp servers on your network
    List of sip servers on your network
    List of ports you run web servers on
    List of ports you want to look for SHELLCODE on.
    List of ports you might see oracle attacks on
    List of ports you want to look for SSH connections on:
    List of ports you run ftp servers on
    List of ports you run SIP servers on
    List of file data ports for file inspection
    List of GTP ports for GTP preprocessor
    Valid in Snort, not valid in Snort++. will result in an error
    var 3DMZ_NETS [[10.1.1.1,10.1.1.2,10.2.0.0/16] ]
    var 3DMZ_PORTS 1035
    other variables, these should not be modified
    Path to your rules files (this can be a relative path)
    Note for Windows users: You are advised to make this an absolute path,
    such as: c:\snort\rules
    If you are using reputation preprocessor set these
    ##################################################
    Step #2: Configure the decoder.
    ##################################################
    Stop generic decode events:
    Configure IP / TCP checksum mode
    Configure maximum number of flowbit references.
    Configure ports to ignore
    Configure default snaplen. Snort defaults to MTU of in use interface.
    Configure DAQ related options for inline operation.


    config daq: <type>
    config daq_dir: <dir>
    config daq_mode: <mode>
    config daq_var: <var>


    <type> ::= pcap | afpacket | dump | nfq | ipq | ipfw
    <mode> ::= read-file | passive | inline
    <var> ::= arbitrary <name>=<value passed to DAQ
    <dir> ::= path as to where to look for DAQ module so's
    Configure default bpf_file to use for filtering what traffic reaches snort.
        For more information see snort -h command line options (-F)
    Configure default log directory for snort to log to. For more information
        see snort -h command line options (-l)
    --option deleted: config alertfile: alert_file.out
    ##################################################
    Step #3: Configure the base detection engine.
    ##################################################
    Configure PCRE match limitations
    Configure the detection engine. See the Snort Manual, Configuring Snort -
        Includes - Config
    Configure the event queue.
    ##################################################
    # Configure GTP if it is to be used.
    ###################################################
    ##################################################
    Per packet and rule latency enforcement
    ##################################################
    Per Packet latency configuration
    Per Rule latency configuration
    ##################################################
    Configure Perf Profiling for debugging
    ##################################################
    ##################################################
    Step #4: Configure dynamic loaded libraries.
    For more information, see Snort Manual, Configuring Snort - Dynamic Modules
    ##################################################
    path to dynamic preprocessor libraries
    path to base preprocessor engine
    path to dynamic rules libraries
    ##################################################
    Step #5: Configure preprocessors
    For more information, see the Snort Manual, Configuring Snort -
        Preprocessors
    ##################################################
    GTP Control Channel Preprocessor.
    Inline packet normalization.
    Does nothing in IDS mode
    Target-based IP defragmentation.
    Target-Based stateful inspection/stream reassembly.
    performance statistics. For more information, see the Snort Manual,
        Configuring Snort - Preprocessors - Performance Monitor
    HTTP normalization and anomaly detection.
    ONC-RPC normalization and anomaly detection. For more information, see the
        Snort Manual, Configuring Snort - Preprocessors - RPC Decode
    Back Orifice detection.
    FTP / Telnet normalization and anomaly detection.
    Portscan detection.
    ARP spoof detection. For more information, see the Snort Manual -
        Configuring Snort - Preprocessors - ARP Spoof Preprocessor
    ##################################################
    Step #6: Configure output plugins
    For more information, see Snort Manual, Configuring Snort - Output Modules
    ##################################################
    unified2
    Recommended for most installs
    Additional configuration for specific types of installs
    metadata reference data
    The following includes information for prioritizing rules


    Each classification includes a shortname, a description, and a default
    priority for that classification.
    ##################################################
    Step #7: Customize your rule set
    For more information, see Snort Manual, Writing Snort Rules


    NOTE: All categories are enabled in this conf file
    ##################################################
    site specific rules
    Event thresholding or suppression commands.
--]]
