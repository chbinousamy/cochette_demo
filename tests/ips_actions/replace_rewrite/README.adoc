=== Replace and Rewrite

This test is to verify replace ips option with rewrite action.

Test verifies:

1. A local rule using replace keyword with rewrite action is triggered.

In the configuration we have a single rule:

rewrite tcp 10.1.1.87 any -> 10.1.1.0/24 80
(
    sid:1000002; gid:1; rev:1;
    msg:"45921 test 3 replace rule";
    content:"index.php", nocase;
    replace:"indax.php";
)

This example will replace the content of "index.php" when found with "indax.php".

In original pcap we see the content as "index.php"

12:45:12.425970 IP 10.1.1.87.22217 > 10.1.1.186.http: Flags [P.], seq 1:387, ack 1, win 5792, options [nop,nop,TS val 0 ecr 2402722993], length 386: HTTP: GET /index.php HTTP/1.1

In the expected pcap (or in the inline-out.pcap) we can see the content has been changed to "indax.php"

12:45:12.425970 IP 10.1.1.87.22217 > 10.1.1.186.http: Flags [P.], seq 1:387, ack 1, win 5792, options [nop,nop,nop,nop,nop,nop,nop,nop,nop,nop,nop,nop], length 386: HTTP: GET /indax.php HTTP/1.1

Note: the inline-out.pcap can be generated by using the options "-Q --daq dump" to generate a pcap of the traffic passed through snort.
